[
["index.html", "ARMA Modeling 1 Introduction", " ARMA Modeling Weiyi Weng March 2021 1 Introduction This project was written on weiyis-MacBook-Pro.local with Statamarkdown version 0.6.0, knitr version 1.31 and Stata SE version 15. The package Statamarkdown is used to produce documents based on Stata using R Markdown. Statamarkdown can be installed from github.com. library(devtools) # before this you may need to install devtools install_github(&quot;hemken/Statamarkdown&quot;) More tutorials for Statamarkdown can be found in Using Statamarkdown. "],
["import-data.html", "2 Import Data 2.1 Import data in .csv format 2.2 specify the time variable &amp; declare the data to be time series 2.3 save processed data as .dta file for future use", " 2 Import Data 2.1 Import data in .csv format missing values in spreadsheet should be coded as “.”, not “n.a.” or \" \" By default, all variable names are imported as lowercase disucss infile vs. insheet, outfile vs. outsheet insheet using &quot;/Users/weiyiweng/Desktop/R/Econ825/project_ARMA/US_IFS_2006.csv&quot;, names comma clear check variable type: numeric vs. string describe Contains data obs: 200 vars: 17 size: 14,000 -------------------------------------------------------------------------------------------------------------- storage display value variable name type format label variable label -------------------------------------------------------------------------------------------------------------- time str6 %9s reer float %9.0g REER m1 float %9.0g M1 m2 float %9.0g M2 base float %9.0g BASE fed_fund float %9.0g FED_FUND t_bill float %9.0g T_BILL prime float %9.0g PRIME t_bond10 float %9.0g T_BOND10 ppi float %9.0g PPI cpi float %9.0g CPI labor float %9.0g LABOR unemploy float %9.0g UNEMPLOY revenue float %9.0g REVENUE gdp float %9.0g GDP gdp_def float %9.0g GDP_DEF gni float %9.0g GNI -------------------------------------------------------------------------------------------------------------- Sorted by: Note: Dataset has changed since last saved. check for missing values: none at the beginning or in the middle of the sample list time m2 gdp | time m2 gdp | |----------------------------| 1. | 1957Q1 123.5 457.2 | 2. | 1957Q2 127.18 459.2 | 3. | 1957Q3 129.14 466.4 | 4. | 1957Q4 132.47 461.5 | 5. | 1958Q1 137.21 454 | |----------------------------| 6. | 1958Q2 142.61 458.1 | 7. | 1958Q3 145.07 471.7 | 8. | 1958Q4 148.45 485 | 9. | 1959Q1 150.96 495.4 | 10. | 1959Q2 154.83 508.4 | |----------------------------| 11. | 1959Q3 156.56 509.3 | 12. | 1959Q4 159.07 513.2 | 13. | 1960Q1 161.05 526.9 | 14. | 1960Q2 164.97 526.1 | 15. | 1960Q3 168.68 528.9 | |----------------------------| 16. | 1960Q4 174.08 523.6 | 17. | 1961Q1 180.02 527.9 | 18. | 1961Q2 186.44 539 | 19. | 1961Q3 189.88 549.4 | 20. | 1961Q4 194.77 562.5 | |----------------------------| 21. | 1962Q1 203.12 576 | 22. | 1962Q2 210.49 583.2 | 23. | 1962Q3 215 590 | 24. | 1962Q4 222.91 593.3 | 25. | 1963Q1 231.1 602.4 | |----------------------------| 26. | 1963Q2 238.4 611.2 | 27. | 1963Q3 243.12 623.9 | 28. | 1963Q4 251.59 633.5 | 29. | 1964Q1 258.79 649.6 | 30. | 1964Q2 266.16 658.8 | |----------------------------| 31. | 1964Q3 271.87 670.5 | 32. | 1964Q4 280.76 675.6 | 33. | 1965Q1 290.27 695.7 | 34. | 1965Q2 297.67 708.1 | 35. | 1965Q3 304.43 725.2 | |----------------------------| 36. | 1965Q4 313.36 747.5 | 37. | 1966Q1 320.03 770.8 | 38. | 1966Q2 325.81 779.9 | 39. | 1966Q3 328.12 793.4 | 40. | 1966Q4 333.37 807.1 | |----------------------------| 41. | 1967Q1 346.28 817.9 | 42. | 1967Q2 357.21 822.5 | 43. | 1967Q3 365.13 837.1 | 44. | 1967Q4 372.72 852.8 | 45. | 1968Q1 381.82 879.9 | |----------------------------| 46. | 1968Q2 386.56 904.2 | 47. | 1968Q3 395.93 919.4 | 48. | 1968Q4 406.33 936.3 | 49. | 1969Q1 409.07 961 | 50. | 1969Q2 409.62 976.3 | |----------------------------| 51. | 1969Q3 404.18 996.5 | 52. | 1969Q4 404.42 1004.6 | 53. | 1970Q1 408.22 1017.3 | 54. | 1970Q2 420.25 1033.2 | 55. | 1970Q3 441.65 1050.7 | |----------------------------| 56. | 1970Q4 460.94 1052.9 | 57. | 1971Q1 490.46 1098.3 | 58. | 1971Q2 507.96 1119.1 | 59. | 1971Q3 522.96 1139.3 | 60. | 1971Q4 542.46 1151.7 | |----------------------------| 61. | 1972Q1 566.92 1192.5 | 62. | 1972Q2 587.53 1225.9 | 63. | 1972Q3 607.05 1249.7 | 64. | 1972Q4 627.8 1287 | 65. | 1973Q1 658.74 1335.5 | |----------------------------| 66. | 1973Q2 677.42 1371.9 | 67. | 1973Q3 692.14 1391.2 | 68. | 1973Q4 703.4 1432.3 | 69. | 1974Q1 730.04 1447 | 70. | 1974Q2 750.96 1485.3 | |----------------------------| 71. | 1974Q3 759.12 1514.2 | 72. | 1974Q4 776.73 1553.4 | 73. | 1975Q1 805.21 1570 | 74. | 1975Q2 826.31 1605.6 | 75. | 1975Q3 843.26 1663.1 | |----------------------------| 76. | 1975Q4 865.83 1714.6 | 77. | 1976Q1 897.12 1772.6 | 78. | 1976Q2 919.65 1804.9 | 79. | 1976Q3 940.61 1838.3 | 80. | 1976Q4 975.38 1885.3 | |----------------------------| 81. | 1977Q1 1013.54 1939.3 | 82. | 1977Q2 1036.64 2006 | 83. | 1977Q3 1067.35 2066.8 | 84. | 1977Q4 1099.07 2111.6 | 85. | 1978Q1 1137.79 2150 | |----------------------------| 86. | 1978Q2 1164.14 2275.6 | 87. | 1978Q3 1196.07 2336.2 | 88. | 1978Q4 1226.29 2417 | 89. | 1979Q1 1260.67 2464.4 | 90. | 1979Q2 1277.9 2527.6 | |----------------------------| 91. | 1979Q3 1317.74 2600.7 | 92. | 1979Q4 1348.2 2660.5 | 93. | 1980Q1 1392.3 2725.3 | 94. | 1980Q2 1427.01 2729.3 | 95. | 1980Q3 1463.34 2786.6 | |----------------------------| 96. | 1980Q4 1521.48 2916.9 | 97. | 1981Q1 1578.97 3052.7 | 98. | 1981Q2 1613.82 3085.9 | 99. | 1981Q3 1677.17 3178.7 | 100. | 1981Q4 1740.79 3196.4 | |----------------------------| 101. | 1982Q1 1785.73 3186.8 | 102. | 1982Q2 1826.36 3242.7 | 103. | 1982Q3 1887.8 3276.2 | 104. | 1982Q4 1926.2 3314.4 | 105. | 1983Q1 1964.35 3382.9 | |----------------------------| 106. | 1983Q2 1985.79 3484.1 | 107. | 1983Q3 2033.16 3589.3 | 108. | 1983Q4 2088.96 3690.4 | 109. | 1984Q1 2155.28 3809.6 | 110. | 1984Q2 2224.29 3908.6 | |----------------------------| 111. | 1984Q3 2275.99 3978.2 | 112. | 1984Q4 2374.07 4036.3 | 113. | 1985Q1 2432.32 4119.5 | 114. | 1985Q2 2470.11 4178.4 | 115. | 1985Q3 2503.76 4261.3 | |----------------------------| 116. | 1985Q4 2539.85 4321.8 | 117. | 1986Q1 2600.38 4385.6 | 118. | 1986Q2 2633.6 4425.7 | 119. | 1986Q3 2689.35 4493.9 | 120. | 1986Q4 2720.06 4546.1 | |----------------------------| 121. | 1987Q1 2740.67 4613.8 | 122. | 1987Q2 2762.06 4690 | 123. | 1987Q3 2791.28 4767.8 | 124. | 1987Q4 2861.89 4886.3 | 125. | 1988Q1 2972.14 4951.9 | |----------------------------| 126. | 1988Q2 2981.78 5062.8 | 127. | 1988Q3 3029.25 5146.6 | 128. | 1988Q4 3072.1 5253.7 | 129. | 1989Q1 3127.86 5367.1 | 130. | 1989Q2 3171.68 5454.1 | |----------------------------| 131. | 1989Q3 3233.52 5531.9 | 132. | 1989Q4 3272.95 5584.3 | 133. | 1990Q1 3323.39 5716.4 | 134. | 1990Q2 3300.48 5797.7 | 135. | 1990Q3 3325.04 5849.4 | |----------------------------| 136. | 1990Q4 3340.04 5848.8 | 137. | 1991Q1 3427.14 5888 | 138. | 1991Q2 3381.64 5964.3 | 139. | 1991Q3 3358.03 6035.6 | 140. | 1991Q4 3325.09 6095.8 | |----------------------------| 141. | 1992Q1 3344.14 6196.1 | 142. | 1992Q2 3280.98 6290.1 | 143. | 1992Q3 3248 6380.5 | 144. | 1992Q4 3200.26 6484.3 | 145. | 1993Q1 3192.19 6542.7 | |----------------------------| 146. | 1993Q2 3153.76 6612.1 | 147. | 1993Q3 3121.96 6674.6 | 148. | 1993Q4 3119.71 6800.2 | 149. | 1994Q1 3136.24 6911 | 150. | 1994Q2 3098.47 7030.6 | |----------------------------| 151. | 1994Q3 3119.66 7115.1 | 152. | 1994Q4 3140.87 7232.2 | 153. | 1995Q1 3219.97 7298.3 | 154. | 1995Q2 3309.57 7337.7 | 155. | 1995Q3 3394.98 7432.1 | |----------------------------| 156. | 1995Q4 3466.91 7522.5 | 157. | 1996Q1 3622.2 7624.1 | 158. | 1996Q2 3637.42 7776.6 | 159. | 1996Q3 3729.03 7866.2 | 160. | 1996Q4 3839.26 8000.4 | |----------------------------| 161. | 1997Q1 3968.2 8113.8 | 162. | 1997Q2 4020.68 8250.4 | 163. | 1997Q3 4135.54 8381.9 | 164. | 1997Q4 4234.06 8471.2 | 165. | 1998Q1 4411.71 8586.7 | |----------------------------| 166. | 1998Q2 4443.64 8657.9 | 167. | 1998Q3 4572.97 8789.5 | 168. | 1998Q4 4745.2 8953.8 | 169. | 1999Q1 4852.43 9066.6 | 170. | 1999Q2 4859.41 9174.1 | |----------------------------| 171. | 1999Q3 4966.96 9313.5 | 172. | 1999Q4 5214.95 9519.5 | 173. | 2000Q1 5402.45 9629.4 | 174. | 2000Q2 5418.45 9822.8 | 175. | 2000Q3 5589.62 9862.1 | |----------------------------| 176. | 2000Q4 5811.84 9953.6 | 177. | 2001Q1 6141.08 10021.5 | 178. | 2001Q2 6203.07 10128.9 | 179. | 2001Q3 6378.1 10135.1 | 180. | 2001Q4 6331.8 10226.3 | |----------------------------| 181. | 2002Q1 6458.82 10333.3 | 182. | 2002Q2 6441.57 10426.6 | 183. | 2002Q3 6508.34 10527.4 | 184. | 2002Q4 6663.58 10591.1 | 185. | 2003Q1 6799.45 10705.6 | |----------------------------| 186. | 2003Q2 6837.15 10831.8 | 187. | 2003Q3 6866.54 11086.1 | 188. | 2003Q4 6908.75 11219.5 | 189. | 2004Q1 7049.34 11430.9 | 190. | 2004Q2 7099.6 11649.3 | |----------------------------| 191. | 2004Q3 7173.79 11799.4 | 192. | 2004Q4 7253.97 11970.3 | 193. | 2005Q1 7416.82 12173.2 | 194. | 2005Q2 7450.99 12346.1 | 195. | 2005Q3 7679.1 12573.5 | |----------------------------| 196. | 2005Q4 7914.44 12730.5 | 197. | 2006Q1 8087.9 13008.4 | 198. | 2006Q2 8179.93 13197.3 | 199. | 2006Q3 . . | 200. | 2006Q4 . . | +----------------------------+ 2.2 specify the time variable &amp; declare the data to be time series gen time_2=quarterly(time,&quot;yq&quot;) /* quarterly() converts a string to a numeric time representation, 1960q1=0 */ describe time_2 m2 gdp storage display value variable name type format label variable label -------------------------------------------------------------------------------------------------------------- time_2 float %9.0g m2 float %9.0g M2 gdp float %9.0g GDP list time time_2 in 1/6 /* time_2 is a numeric, but not properly formated */ | time time_2 | |-----------------| 1. | 1957Q1 -12 | 2. | 1957Q2 -11 | 3. | 1957Q3 -10 | 4. | 1957Q4 -9 | 5. | 1958Q1 -8 | |-----------------| 6. | 1958Q2 -7 | +-----------------+ declare the data to be time series (gaps allowed), and format time_2 tsset time_2, quarterly describe time_2 m2 gdp time variable: time_2, 1957q1 to 2006q4 delta: 1 quarter storage display value variable name type format label variable label -------------------------------------------------------------------------------------------------------------- time_2 float %tq m2 float %9.0g M2 gdp float %9.0g GDP list time time_2 in 1/6 | time time_2 | |-----------------| 1. | 1957Q1 1957q1 | 2. | 1957Q2 1957q2 | 3. | 1957Q3 1957q3 | 4. | 1957Q4 1957q4 | 5. | 1958Q1 1958q1 | |-----------------| 6. | 1958Q2 1958q2 | +-----------------+ 2.3 save processed data as .dta file for future use save &quot;/Users/weiyiweng/Desktop/R/Econ825/project_ARMA/US_IFS_2006.dta&quot;, replace "],
["preliminary-analysis.html", "3 Preliminary Analysis", " 3 Preliminary Analysis Load Stata data file use &quot;/Users/weiyiweng/Desktop/R/Econ825/project_ARMA/US_IFS_2006.dta&quot;, clear time series plot tsline gdp variable transformation gen yyy=log(gdp) label var yyy &quot;log(GDP)&quot; tsline yyy summary statistics /* sample statistics may not be well defined for nonstationary data */ codebook gdp codebook yyy gdp GDP -------------------------------------------------------------------------------------------------------------- type: numeric (float) range: [454,13197.3] units: .1 unique values: 198 missing .: 2/200 mean: 4270.62 std. dev: 3672.77 percentiles: 10% 25% 50% 75% 90% -------------------------------------------------------------------------------------------------------------- yyy log(GDP) -------------------------------------------------------------------------------------------------------------- type: numeric (float) range: [6.1180973,9.4877672] units: 1.000e-07 unique values: 198 missing .: 2/200 mean: 7.88039 std. dev: 1.06695 percentiles: 10% 25% 50% 75% 90% "],
["unit-root-tests.html", "4 Unit Root Tests 4.1 ADF Test 4.2 ADF-GLS Tests 4.3 Sample AC", " 4 Unit Root Tests time series plot tsline yyy tsline d.yyy tsline d2.yyy 4.1 ADF Test gen trend=_n /* this step is necessary b/c _n cannot be used directly as a regressor */ scalar T=198 /* # of nonmissing observations */ scalar pmax=int(12*((T+1)/100)^0.25) /* Schwert (1989), pmax=int[12*{(T+1)/100}^0.25]=14 */ scalar list pmax pmax = 14 4.1.1 ADF Test in level reg yyy trend l.yyy l(1/14)d.yyy estat ic matrix y_order=r(S) cap drop touse gen touse=e(sample) /* set up common sample */ reg yyy trend l.yyy l(1/13)d.yyy if touse==1 estat ic matrix y_order=(y_order \\ r(S)) reg yyy trend l.yyy l(1/12)d.yyy if touse==1 estat ic matrix y_order=(y_order \\ r(S)) reg yyy trend l.yyy l(1/11)d.yyy if touse==1 estat ic matrix y_order=(y_order \\ r(S)) reg yyy trend l.yyy l(1/10)d.yyy if touse==1 estat ic matrix y_order=(y_order \\ r(S)) reg yyy trend l.yyy l(1/9)d.yyy if touse==1 estat ic matrix y_order=(y_order \\ r(S)) reg yyy trend l.yyy l(1/8)d.yyy if touse==1 estat ic matrix y_order=(y_order \\ r(S)) reg yyy trend l.yyy l(1/7)d.yyy if touse==1 estat ic matrix y_order=(y_order \\ r(S)) reg yyy trend l.yyy l(1/6)d.yyy if touse==1 estat ic matrix y_order=(y_order \\ r(S)) reg yyy trend l.yyy l(1/5)d.yyy if touse==1 estat ic matrix y_order=(y_order \\ r(S)) reg yyy trend l.yyy l(1/4)d.yyy if touse==1 estat ic matrix y_order=(y_order \\ r(S)) reg yyy trend l.yyy l(1/3)d.yyy if touse==1 estat ic matrix y_order=(y_order \\ r(S)) reg yyy trend l.yyy l(1/2)d.yyy if touse==1 estat ic matrix y_order=(y_order \\ r(S)) reg yyy trend l.yyy ld.yyy if touse==1 estat ic matrix y_order=(y_order \\ r(S)) reg yyy trend l.yyy if touse==1 estat ic matrix y_order=(y_order \\ r(S)) matlist y_order\t/* AIC: P=11, SBC: P=2 */ dfuller yyy, trend lag(11) dfuller yyy, trend lag(2) | N ll0 ll df AIC BIC -------------+------------------------------------------------------------------ . | 183 -257.0172 633.4724 17 -1232.945 -1178.383 . | 183 -257.0172 632.8139 16 -1233.628 -1182.276 . | 183 -257.0172 632.7759 15 -1235.552 -1187.409 . | 183 -257.0172 632.5419 14 -1237.084 -1192.151 . | 183 -257.0172 628.9216 13 -1231.843 -1190.12 . | 183 -257.0172 625.8929 12 -1227.786 -1189.272 . | 183 -257.0172 623.7661 11 -1225.532 -1190.228 . | 183 -257.0172 623.709 10 -1227.418 -1195.323 . | 183 -257.0172 623.4871 9 -1228.974 -1200.089 . | 183 -257.0172 623.2461 8 -1230.492 -1204.816 . | 183 -257.0172 623.1844 7 -1232.369 -1209.902 . | 183 -257.0172 621.7903 6 -1231.581 -1212.324 . | 183 -257.0172 621.7117 5 -1233.423 -1217.376 . | 183 -257.0172 618.4891 4 -1228.978 -1216.14 . | 183 -257.0172 609.5378 3 -1213.076 -1203.447 Augmented Dickey-Fuller test for unit root Number of obs = 186 ---------- Interpolated Dickey-Fuller --------- Test 1% Critical 5% Critical 10% Critical Statistic Value Value Value ------------------------------------------------------------------------------ Z(t) -1.420 -4.011 -3.439 -3.139 ------------------------------------------------------------------------------ MacKinnon approximate p-value for Z(t) = 0.8551 Augmented Dickey-Fuller test for unit root Number of obs = 195 ---------- Interpolated Dickey-Fuller --------- Test 1% Critical 5% Critical 10% Critical Statistic Value Value Value ------------------------------------------------------------------------------ Z(t) -0.099 -4.008 -3.437 -3.137 ------------------------------------------------------------------------------ MacKinnon approximate p-value for Z(t) = 0.9931 Lag order = 11 (AIC) reg yyy trend l.yyy l(1/11)d.yyy lincom L1.yyy-1 cap drop res predict res, residuals corrgram res, lags(24) /* not serially correlated */ Source | SS df MS Number of obs = 186 -------------+---------------------------------- F(13, 172) &gt; 99999.00 Model | 186.820141 13 14.3707801 Prob &gt; F = 0.0000 Residual | .011091436 172 .000064485 R-squared = 0.9999 -------------+---------------------------------- Adj R-squared = 0.9999 Total | 186.831232 185 1.00989855 Root MSE = .00803 ------------------------------------------------------------------------------ yyy | Coef. Std. Err. t P&gt;|t| [95% Conf. Interval] -------------+---------------------------------------------------------------- trend | .0001364 .0001098 1.24 0.216 -.0000804 .0003531 | yyy | L1. | .9918322 .0057537 172.38 0.000 .9804752 1.003189 LD. | .1760053 .0744998 2.36 0.019 .0289536 .3230569 L2D. | .1483786 .0741584 2.00 0.047 .0020009 .2947563 L3D. | -.0004151 .0744099 -0.01 0.996 -.1472893 .1464591 L4D. | .1089375 .0738653 1.47 0.142 -.0368618 .2547367 L5D. | -.0436229 .0741307 -0.59 0.557 -.189946 .1027002 L6D. | .0517838 .0736841 0.70 0.483 -.0936577 .1972254 L7D. | .0045833 .0734252 0.06 0.950 -.1403472 .1495138 L8D. | -.0908234 .0712122 -1.28 0.204 -.2313857 .0497389 L9D. | .0964239 .0705953 1.37 0.174 -.0429209 .2357686 L10D. | .1633627 .0705073 2.32 0.022 .0241917 .3025336 L11D. | .1689831 .0698401 2.42 0.017 .0311291 .3068372 | _cons | .0546618 .033325 1.64 0.103 -.0111169 .1204405 ------------------------------------------------------------------------------ ( 1) L.yyy = 1 ------------------------------------------------------------------------------ yyy | Coef. Std. Err. t P&gt;|t| [95% Conf. Interval] -------------+---------------------------------------------------------------- (1) | -.0081678 .0057537 -1.42 0.158 -.0195248 .0031891 ------------------------------------------------------------------------------ (14 missing values generated) -1 0 1 -1 0 1 LAG AC PAC Q Prob&gt;Q [Autocorrelation] [Partial Autocor] ------------------------------------------------------------------------------- 1 0.0172 0.0172 .05595 0.8130 | | 2 0.0118 0.0112 .08224 0.9597 | | 3 -0.0383 -0.0390 .36181 0.9480 | | 4 -0.0230 -0.0211 .46359 0.9769 | | 5 -0.0815 -0.0815 1.7453 0.8831 | | 6 -0.0253 -0.0218 1.8692 0.9313 | | 7 -0.0281 -0.0281 2.023 0.9586 | | 8 0.0197 0.0153 2.0992 0.9778 | | 9 -0.0024 -0.0058 2.1003 0.9898 | | 10 -0.0441 -0.0562 2.4873 0.9911 | | 11 -0.0461 -0.0488 2.9115 0.9918 | | 12 -0.1446 -0.1581 7.1136 0.8500 -| -| 13 -0.0234 -0.0250 7.2241 0.8902 | | 14 0.0068 0.0022 7.2334 0.9253 | | 15 -0.0653 -0.0913 8.1042 0.9195 | | 16 0.1587 0.1656 13.285 0.6518 |- |- 17 -0.0205 -0.0746 13.373 0.7109 | | 18 0.0893 0.0887 15.033 0.6597 | | 19 -0.0332 -0.0560 15.264 0.7057 | | 20 0.0657 0.0526 16.174 0.7058 | | 21 0.0069 0.0435 16.184 0.7592 | | 22 0.0282 0.0019 16.354 0.7979 | | 23 -0.0835 -0.0513 17.849 0.7656 | | 24 0.0556 0.0484 18.517 0.7772 | | Lag order = 2 (SBC) reg yyy trend l.yyy l(1/2)d.yyy lincom L1.yyy-1 cap drop res predict res, residuals corrgram res, lags(24) /* serially correlated */ Source | SS df MS Number of obs = 195 -------------+---------------------------------- F(4, 190) &gt; 99999.00 Model | 214.947669 4 53.7369172 Prob &gt; F = 0.0000 Residual | .015137911 190 .000079673 R-squared = 0.9999 -------------+---------------------------------- Adj R-squared = 0.9999 Total | 214.962807 194 1.1080557 Root MSE = .00893 ------------------------------------------------------------------------------ yyy | Coef. Std. Err. t P&gt;|t| [95% Conf. Interval] -------------+---------------------------------------------------------------- trend | -4.28e-06 .0001066 -0.04 0.968 -.0002147 .0002061 | yyy | L1. | .9994388 .0056897 175.66 0.000 .9882158 1.010662 LD. | .3077581 .0720781 4.27 0.000 .165582 .4499343 L2D. | .1453238 .0720991 2.02 0.045 .0031063 .2875413 | _cons | .0142463 .0339685 0.42 0.675 -.0527575 .08125 ------------------------------------------------------------------------------ ( 1) L.yyy = 1 ------------------------------------------------------------------------------ yyy | Coef. Std. Err. t P&gt;|t| [95% Conf. Interval] -------------+---------------------------------------------------------------- (1) | -.0005612 .0056897 -0.10 0.922 -.0117842 .0106618 ------------------------------------------------------------------------------ (5 missing values generated) -1 0 1 -1 0 1 LAG AC PAC Q Prob&gt;Q [Autocorrelation] [Partial Autocor] ------------------------------------------------------------------------------- 1 0.0026 0.0026 .00139 0.9703 | | 2 -0.0334 -0.0333 .22353 0.8943 | | 3 -0.0590 -0.0605 .91896 0.8208 | | 4 0.0674 0.0657 1.8318 0.7667 | | 5 -0.0393 -0.0370 2.144 0.8289 | | 6 0.0786 0.0802 3.3995 0.7573 | | 7 0.0522 0.0613 3.9567 0.7848 | | 8 -0.0760 -0.0829 5.1435 0.7421 | | 9 0.0576 0.0666 5.8279 0.7570 | | 10 0.1709 0.1663 11.892 0.2924 |- |- 11 0.2196 0.2283 21.957 0.0247 |- |- 12 -0.0240 0.0149 22.078 0.0367 | | 13 0.0249 0.0296 22.209 0.0522 | | 14 0.0279 0.0436 22.374 0.0712 | | 15 -0.0402 -0.0718 22.72 0.0903 | | 16 0.1188 0.1398 25.75 0.0577 | |- 17 -0.0232 -0.0606 25.865 0.0769 | | 18 0.0984 0.1187 27.966 0.0626 | | 19 -0.0226 0.0113 28.078 0.0819 | | 20 0.1350 0.0404 32.076 0.0425 |- | 21 0.0377 0.0472 32.389 0.0534 | | 22 0.0443 -0.0346 32.825 0.0644 | | 23 -0.0803 -0.0478 34.267 0.0614 | | 24 0.0262 -0.0079 34.422 0.0774 | | 4.1.2 ADF Test in first-difference reg d.yyy ld.yyy l(1/14)d2.yyy estat ic matrix dy_order=r(S) cap drop touse gen touse=e(sample)\t/* set up common sample */ reg d.yyy ld.yyy l(1/13)d2.yyy if touse==1 estat ic matrix dy_order=(dy_order \\ r(S)) reg d.yyy ld.yyy l(1/12)d2.yyy if touse==1 estat ic matrix dy_order=(dy_order \\ r(S)) reg d.yyy ld.yyy l(1/11)d2.yyy if touse==1 estat ic matrix dy_order=(dy_order \\ r(S)) reg d.yyy ld.yyy l(1/10)d2.yyy if touse==1 estat ic matrix dy_order=(dy_order \\ r(S)) reg d.yyy ld.yyy l(1/9)d2.yyy if touse==1 estat ic matrix dy_order=(dy_order \\ r(S)) reg d.yyy ld.yyy l(1/8)d2.yyy if touse==1 estat ic matrix dy_order=(dy_order \\ r(S)) reg d.yyy ld.yyy l(1/7)d2.yyy if touse==1 estat ic matrix dy_order=(dy_order \\ r(S)) reg d.yyy ld.yyy l(1/6)d2.yyy if touse==1 estat ic matrix dy_order=(dy_order \\ r(S)) reg d.yyy ld.yyy l(1/5)d2.yyy if touse==1 estat ic matrix dy_order=(dy_order \\ r(S)) reg d.yyy ld.yyy l(1/4)d2.yyy if touse==1 estat ic matrix dy_order=(dy_order \\ r(S)) reg d.yyy ld.yyy l(1/3)d2.yyy if touse==1 estat ic matrix dy_order=(dy_order \\ r(S)) reg d.yyy ld.yyy l(1/2)d2.yyy if touse==1 estat ic matrix dy_order=(dy_order \\ r(S)) reg d.yyy ld.yyy ld2.yyy if touse==1 estat ic matrix dy_order=(dy_order \\ r(S)) reg d.yyy ld.yyy if touse==1 estat ic matrix dy_order=(dy_order \\ r(S)) matlist dy_order /* AIC: P=10, SBC: P=1 */ dfuller d.yyy, lag(10) dfuller d.yyy, lag(1) | N ll0 ll df AIC BIC -------------+------------------------------------------------------------------ . | 182 602.7104 630.0384 16 -1228.077 -1176.813 . | 182 602.7104 629.8362 15 -1229.672 -1181.612 . | 182 602.7104 629.5994 14 -1231.199 -1186.343 . | 182 602.7104 629.5726 13 -1233.145 -1191.493 . | 182 602.7104 628.7136 12 -1233.427 -1194.979 . | 182 602.7104 626.7977 11 -1231.595 -1196.351 . | 182 602.7104 624.4462 10 -1228.892 -1196.852 . | 182 602.7104 621.2728 9 -1224.546 -1195.71 . | 182 602.7104 621.2664 8 -1226.533 -1200.901 . | 182 602.7104 620.8356 7 -1227.671 -1205.243 . | 182 602.7104 619.974 6 -1227.948 -1208.724 . | 182 602.7104 619.8678 5 -1229.736 -1213.716 . | 182 602.7104 618.2495 4 -1228.499 -1215.683 . | 182 602.7104 618.19 3 -1230.38 -1220.768 . | 182 602.7104 614.6538 2 -1225.308 -1218.9 Augmented Dickey-Fuller test for unit root Number of obs = 186 ---------- Interpolated Dickey-Fuller --------- Test 1% Critical 5% Critical 10% Critical Statistic Value Value Value ------------------------------------------------------------------------------ Z(t) -2.027 -3.481 -2.884 -2.574 ------------------------------------------------------------------------------ MacKinnon approximate p-value for Z(t) = 0.2750 Augmented Dickey-Fuller test for unit root Number of obs = 195 ---------- Interpolated Dickey-Fuller --------- Test 1% Critical 5% Critical 10% Critical Statistic Value Value Value ------------------------------------------------------------------------------ Z(t) -6.662 -3.478 -2.884 -2.574 ------------------------------------------------------------------------------ MacKinnon approximate p-value for Z(t) = 0.0000 Lag order = 10 (AIC) reg d.yyy ld.yyy l(1/10)d2.yyy lincom LD.yyy-1 cap drop res predict res, residuals corrgram res, lags(24) /* not serially correlated */ Source | SS df MS Number of obs = 186 -------------+---------------------------------- F(11, 174) = 5.76 Model | .004142641 11 .000376604 Prob &gt; F = 0.0000 Residual | .011379402 174 .000065399 R-squared = 0.2669 -------------+---------------------------------- Adj R-squared = 0.2205 Total | .015522044 185 .000083903 Root MSE = .00809 ------------------------------------------------------------------------------ D.yyy | Coef. Std. Err. t P&gt;|t| [95% Conf. Interval] -------------+---------------------------------------------------------------- yyy | LD. | .7620599 .117401 6.49 0.000 .5303465 .9937733 LD2. | -.5733235 .1279896 -4.48 0.000 -.8259355 -.3207115 L2D2. | -.4225229 .1292552 -3.27 0.001 -.6776328 -.1674131 L3D2. | -.425238 .1239827 -3.43 0.001 -.6699415 -.1805344 L4D2. | -.315886 .1216715 -2.60 0.010 -.556028 -.075744 L5D2. | -.3612647 .1160146 -3.11 0.002 -.5902418 -.1322876 L6D2. | -.3098597 .1071544 -2.89 0.004 -.5213495 -.0983699 L7D2. | -.3056006 .0993365 -3.08 0.002 -.5016603 -.109541 L8D2. | -.4012991 .0901717 -4.45 0.000 -.5792701 -.223328 L9D2. | -.3085368 .0838525 -3.68 0.000 -.4740358 -.1430378 L10D2. | -.1524012 .0693338 -2.20 0.029 -.2892449 -.0155576 | _cons | .0042898 .0021232 2.02 0.045 .0000993 .0084804 ------------------------------------------------------------------------------ ( 1) LD.yyy = 1 ------------------------------------------------------------------------------ D.yyy | Coef. Std. Err. t P&gt;|t| [95% Conf. Interval] -------------+---------------------------------------------------------------- (1) | -.2379401 .117401 -2.03 0.044 -.4696535 -.0062267 ------------------------------------------------------------------------------ (14 missing values generated) -1 0 1 -1 0 1 LAG AC PAC Q Prob&gt;Q [Autocorrelation] [Partial Autocor] ------------------------------------------------------------------------------- 1 0.0191 0.0191 .06907 0.7927 | | 2 0.0222 0.0215 .16238 0.9220 | | 3 -0.0234 -0.0248 .26739 0.9660 | | 4 -0.0078 -0.0066 .27909 0.9911 | | 5 -0.0616 -0.0617 1.0132 0.9615 | | 6 -0.0078 -0.0037 1.025 0.9846 | | 7 -0.0093 -0.0068 1.0419 0.9941 | | 8 0.0413 0.0401 1.3763 0.9946 | | 9 0.0205 0.0198 1.4592 0.9974 | | 10 -0.0187 -0.0270 1.5284 0.9988 | | 11 -0.0133 -0.0119 1.5638 0.9995 | | 12 -0.1281 -0.1338 4.8599 0.9625 -| -| 13 -0.0088 0.0031 4.8755 0.9778 | | 14 0.0190 0.0306 4.9491 0.9865 | | 15 -0.0546 -0.0633 5.5596 0.9862 | | 16 0.1672 0.1910 11.309 0.7900 |- |- 17 -0.0111 -0.0512 11.334 0.8387 | | 18 0.0992 0.1103 13.382 0.7684 | | 19 -0.0233 -0.0371 13.496 0.8123 | | 20 0.0793 0.0777 14.821 0.7865 | | 21 0.0196 0.0630 14.902 0.8278 | | 22 0.0390 0.0190 15.227 0.8523 | | 23 -0.0753 -0.0357 16.444 0.8356 | | 24 0.0635 0.0571 17.313 0.8350 | | Lag order = 1 (SBC) reg d.yyy ld.yyy ld2.yyy lincom LD.yyy-1 cap drop res predict res, residuals corrgram res, lags(24) /* serially correlated */ Source | SS df MS Number of obs = 195 -------------+---------------------------------- F(2, 192) = 18.30 Model | .002910271 2 .001455136 Prob &gt; F = 0.0000 Residual | .015268939 192 .000079526 R-squared = 0.1601 -------------+---------------------------------- Adj R-squared = 0.1513 Total | .01817921 194 .000093707 Root MSE = .00892 ------------------------------------------------------------------------------ D.yyy | Coef. Std. Err. t P&gt;|t| [95% Conf. Interval] -------------+---------------------------------------------------------------- yyy | LD. | .4693837 .0796423 5.89 0.000 .3122976 .6264698 LD2. | -.1527322 .07106 -2.15 0.033 -.2928907 -.0125737 | _cons | .0091067 .0015045 6.05 0.000 .0061392 .0120741 ------------------------------------------------------------------------------ ( 1) LD.yyy = 1 ------------------------------------------------------------------------------ D.yyy | Coef. Std. Err. t P&gt;|t| [95% Conf. Interval] -------------+---------------------------------------------------------------- (1) | -.5306163 .0796423 -6.66 0.000 -.6877024 -.3735302 ------------------------------------------------------------------------------ (5 missing values generated) -1 0 1 -1 0 1 LAG AC PAC Q Prob&gt;Q [Autocorrelation] [Partial Autocor] ------------------------------------------------------------------------------- 1 0.0042 0.0041 .00344 0.9532 | | 2 -0.0308 -0.0306 .19221 0.9084 | | 3 -0.0515 -0.0527 .72389 0.8676 | | 4 0.0742 0.0735 1.8324 0.7666 | | 5 -0.0326 -0.0299 2.047 0.8426 | | 6 0.0860 0.0885 3.5488 0.7375 | | 7 0.0585 0.0676 4.2492 0.7507 | | 8 -0.0696 -0.0768 5.2444 0.7312 | | 9 0.0645 0.0730 6.104 0.7295 | | 10 0.1776 0.1714 12.652 0.2438 |- |- 11 0.2273 0.2351 23.434 0.0153 |- |- 12 -0.0152 0.0214 23.483 0.0239 | | 13 0.0366 0.0369 23.765 0.0334 | | 14 0.0402 0.0491 24.109 0.0445 | | 15 -0.0290 -0.0683 24.288 0.0604 | | 16 0.1296 0.1437 27.892 0.0326 |- |- 17 -0.0129 -0.0589 27.928 0.0458 | | 18 0.1072 0.1215 30.423 0.0335 | | 19 -0.0124 0.0132 30.457 0.0463 | | 20 0.1445 0.0428 35.041 0.0199 |- | 21 0.0491 0.0498 35.574 0.0244 | | 22 0.0546 -0.0332 36.236 0.0286 | | 23 -0.0700 -0.0477 37.331 0.0300 | | 24 0.0356 -0.0085 37.615 0.0379 | | 4.1.3 ADF Test in second-difference reg d2.yyy ld2.yyy l(1/14)d3.yyy, noconst estat ic matrix d2y_order=r(S) cap drop touse gen touse=e(sample)\t/* set up common sample */ reg d2.yyy ld2.yyy l(1/13)d3.yyy if touse==1, noconst estat ic matrix d2y_order=(d2y_order \\ r(S)) reg d2.yyy ld2.yyy l(1/12)d3.yyy if touse==1, noconst estat ic matrix d2y_order=(d2y_order \\ r(S)) reg d2.yyy ld2.yyy l(1/11)d3.yyy if touse==1, noconst estat ic matrix d2y_order=(d2y_order \\ r(S)) reg d2.yyy ld2.yyy l(1/10)d3.yyy if touse==1, noconst estat ic matrix d2y_order=(d2y_order \\ r(S)) reg d2.yyy ld2.yyy l(1/9)d3.yyy if touse==1, noconst estat ic matrix d2y_order=(d2y_order \\ r(S)) reg d2.yyy ld2.yyy l(1/8)d3.yyy if touse==1, noconst estat ic matrix d2y_order=(d2y_order \\ r(S)) reg d2.yyy ld2.yyy l(1/7)d3.yyy if touse==1, noconst estat ic matrix d2y_order=(d2y_order \\ r(S)) reg d2.yyy ld2.yyy l(1/6)d3.yyy if touse==1, noconst estat ic matrix d2y_order=(d2y_order \\ r(S)) reg d2.yyy ld2.yyy l(1/5)d3.yyy if touse==1, noconst estat ic matrix d2y_order=(d2y_order \\ r(S)) reg d2.yyy ld2.yyy l(1/4)d3.yyy if touse==1, noconst estat ic matrix d2y_order=(d2y_order \\ r(S)) reg d2.yyy ld2.yyy l(1/3)d3.yyy if touse==1, noconst estat ic matrix d2y_order=(d2y_order \\ r(S)) reg d2.yyy ld2.yyy l(1/2)d3.yyy if touse==1, noconst estat ic matrix d2y_order=(d2y_order \\ r(S)) reg d2.yyy ld2.yyy ld3.yyy if touse==1, noconst estat ic matrix d2y_order=(d2y_order \\ r(S)) reg d2.yyy ld2.yyy if touse==1, noconst estat ic matrix d2y_order=(d2y_order \\ r(S)) matlist d2y_order\t/* AIC: P=9 */ dfuller d2.yyy, lag(9) noconstant | N ll0 ll df AIC BIC -------------+------------------------------------------------------------------ . | 181 . 626.6505 15 -1223.301 -1175.324 . | 181 . 623.7481 14 -1219.496 -1174.717 . | 181 . 623.663 13 -1221.326 -1179.746 . | 181 . 623.1454 12 -1222.291 -1183.909 . | 181 . 623.0587 11 -1224.117 -1188.934 . | 181 . 622.4375 10 -1224.875 -1192.89 . | 181 . 619.8311 9 -1221.662 -1192.876 . | 181 . 616.0669 8 -1216.134 -1190.546 . | 181 . 610.7646 7 -1207.529 -1185.14 . | 181 . 610.2553 6 -1208.511 -1189.32 . | 181 . 608.531 5 -1207.062 -1191.07 . | 181 . 605.305 4 -1202.61 -1189.816 . | 181 . 604.7922 3 -1203.584 -1193.989 . | 181 . 598.7061 2 -1193.412 -1187.015 . | 181 . 595.0522 1 -1188.104 -1184.906 Augmented Dickey-Fuller test for unit root Number of obs = 186 ---------- Interpolated Dickey-Fuller --------- Test 1% Critical 5% Critical 10% Critical Statistic Value Value Value ------------------------------------------------------------------------------ Z(t) -9.043 -2.589 -1.950 -1.616 Lag order = 9 (AIC) reg d2.yyy ld2.yyy l(1/9)d3.yyy lincom LD2.yyy-1 cap drop res predict res, residuals corrgram res, lags(24)\t/* not serially correlated */ Source | SS df MS Number of obs = 186 -------------+---------------------------------- F(10, 175) = 13.00 Model | .008653897 10 .00086539 Prob &gt; F = 0.0000 Residual | .011648036 175 .00006656 R-squared = 0.4263 -------------+---------------------------------- Adj R-squared = 0.3935 Total | .020301934 185 .00010974 Root MSE = .00816 ------------------------------------------------------------------------------ D2.yyy | Coef. Std. Err. t P&gt;|t| [95% Conf. Interval] -------------+---------------------------------------------------------------- yyy | LD2. | -4.719296 .6338993 -7.44 0.000 -5.970368 -3.468225 LD3. | 3.933674 .5948827 6.61 0.000 2.759606 5.107742 L2D3. | 3.321413 .5381876 6.17 0.000 2.259239 4.383586 L3D3. | 2.729197 .4778348 5.71 0.000 1.786136 3.672258 L4D3. | 2.267236 .4090331 5.54 0.000 1.459963 3.074509 L5D3. | 1.780092 .3381174 5.26 0.000 1.112779 2.447404 L6D3. | 1.368798 .2691074 5.09 0.000 .8376847 1.899912 L7D3. | .9833365 .1992363 4.94 0.000 .5901212 1.376552 L8D3. | .5220797 .134587 3.88 0.000 .2564571 .7877023 L9D3. | .1728398 .0692029 2.50 0.013 .03626 .3094195 | _cons | .0001582 .0005987 0.26 0.792 -.0010235 .0013398 ------------------------------------------------------------------------------ ( 1) LD2.yyy = 1 ------------------------------------------------------------------------------ D2.yyy | Coef. Std. Err. t P&gt;|t| [95% Conf. Interval] -------------+---------------------------------------------------------------- (1) | -5.719296 .6338993 -9.02 0.000 -6.970368 -4.468225 ------------------------------------------------------------------------------ (14 missing values generated) -1 0 1 -1 0 1 LAG AC PAC Q Prob&gt;Q [Autocorrelation] [Partial Autocor] ------------------------------------------------------------------------------- 1 0.0155 0.0155 .04541 0.8313 | | 2 0.0180 0.0175 .10713 0.9478 | | 3 -0.0340 -0.0351 .32827 0.9546 | | 4 -0.0153 -0.0135 .37306 0.9846 | | 5 -0.0740 -0.0738 1.4321 0.9208 | | 6 -0.0252 -0.0212 1.5554 0.9557 | | 7 -0.0293 -0.0268 1.7226 0.9736 | | 8 0.0208 0.0185 1.8073 0.9864 | | 9 -0.0001 -0.0018 1.8073 0.9942 | | 10 -0.0422 -0.0530 2.1615 0.9949 | | 11 -0.0400 -0.0418 2.4808 0.9960 | | 12 -0.1386 -0.1507 6.3428 0.8978 -| -| 13 -0.0191 -0.0189 6.4162 0.9297 | | 14 0.0089 0.0079 6.4322 0.9544 | | 15 -0.0651 -0.0897 7.2983 0.9488 | | 16 0.1582 0.1678 12.448 0.7126 |- |- 17 -0.0232 -0.0746 12.559 0.7652 | | 18 0.0895 0.0886 14.225 0.7143 | | 19 -0.0317 -0.0524 14.435 0.7577 | | 20 0.0717 0.0619 15.518 0.7460 | | 21 0.0083 0.0451 15.532 0.7953 | | 22 0.0301 0.0048 15.725 0.8293 | | 23 -0.0830 -0.0494 17.204 0.7991 | | 24 0.0532 0.0450 17.814 0.8119 | | AIC: yyy ~ I(2) with drift; SBC: yyy ~ I(1) with drift 4.2 ADF-GLS Tests /* by default, p-max is set according to Schwert (1989), i.e., pmax=int[12*{(T+1)/100}^0.25]=14 */ dfgls yyy\t/* MAIC: P=2, SBC: P=2 */ DF-GLS for yyy Number of obs = 183 Maxlag = 14 chosen by Schwert criterion DF-GLS tau 1% Critical 5% Critical 10% Critical [lags] Test Statistic Value Value Value ------------------------------------------------------------------------------ 14 -2.022 -3.462 -2.798 -2.521 13 -1.859 -3.462 -2.811 -2.533 12 -1.836 -3.462 -2.824 -2.545 11 -1.979 -3.462 -2.837 -2.556 10 -1.581 -3.462 -2.849 -2.568 9 -1.266 -3.462 -2.861 -2.579 8 -1.044 -3.462 -2.872 -2.589 7 -1.055 -3.462 -2.883 -2.599 6 -0.967 -3.462 -2.893 -2.609 5 -0.874 -3.462 -2.903 -2.618 4 -0.889 -3.462 -2.913 -2.626 3 -0.699 -3.462 -2.922 -2.634 2 -0.702 -3.462 -2.930 -2.642 1 -0.422 -3.462 -2.938 -2.649 Opt Lag (Ng-Perron seq t) = 11 with RMSE .0076429 Min SC = -9.519211 at lag 2 with RMSE .0082108 Min MAIC = -9.577197 at lag 2 with RMSE .0082108 dfgls yyy, maxlag(2) DF-GLS for yyy Number of obs = 195 DF-GLS tau 1% Critical 5% Critical 10% Critical [lags] Test Statistic Value Value Value ------------------------------------------------------------------------------ 2 -0.557 -3.462 -2.925 -2.637 1 -0.343 -3.462 -2.932 -2.643 Opt Lag (Ng-Perron seq t) = 2 with RMSE .0088499 Min SC = -9.374977 at lag 1 with RMSE .0089641 Min MAIC = -9.430886 at lag 2 with RMSE .0088499 dfgls d.yyy, notrend\t/* MAIC: P=10, SBC: P=3 */ DF-GLS for D.yyy Number of obs = 182 Maxlag = 14 chosen by Schwert criterion DF-GLS mu 1% Critical 5% Critical 10% Critical [lags] Test Statistic Value Value Value ------------------------------------------------------------------------------ 14 -0.612 -2.587 -1.957 -1.649 13 -0.588 -2.587 -1.964 -1.656 12 -0.653 -2.587 -1.971 -1.663 11 -0.689 -2.587 -1.978 -1.669 10 -0.614 -2.587 -1.985 -1.676 9 -0.769 -2.587 -1.992 -1.682 8 -0.978 -2.587 -1.998 -1.688 7 -1.296 -2.587 -2.005 -1.694 6 -1.407 -2.587 -2.011 -1.700 5 -1.648 -2.587 -2.017 -1.705 4 -1.999 -2.587 -2.023 -1.711 3 -2.144 -2.587 -2.028 -1.715 2 -2.826 -2.587 -2.033 -1.720 1 -3.388 -2.587 -2.038 -1.725 Opt Lag (Ng-Perron seq t) = 10 with RMSE .007741 Min SC = -9.435891 at lag 3 with RMSE .008437 Min MAIC = -9.606157 at lag 10 with RMSE .007741 dfgls d.yyy, maxlag(10) notrend DF-GLS for D.yyy Number of obs = 186 DF-GLS mu 1% Critical 5% Critical 10% Critical [lags] Test Statistic Value Value Value ------------------------------------------------------------------------------ 10 -0.657 -2.587 -1.985 -1.675 9 -0.848 -2.587 -1.991 -1.681 8 -1.162 -2.587 -1.998 -1.687 7 -1.537 -2.587 -2.004 -1.693 6 -1.601 -2.587 -2.010 -1.698 5 -1.761 -2.587 -2.016 -1.704 4 -2.017 -2.587 -2.021 -1.709 3 -2.178 -2.587 -2.027 -1.714 2 -2.813 -2.587 -2.032 -1.718 1 -3.440 -2.587 -2.036 -1.722 Opt Lag (Ng-Perron seq t) = 10 with RMSE .0079054 Min SC = -9.392969 at lag 3 with RMSE .0086286 Min MAIC = -9.565683 at lag 10 with RMSE .0079054 dfgls d.yyy, maxlag(3) notrend DF-GLS for D.yyy Number of obs = 193 DF-GLS mu 1% Critical 5% Critical 10% Critical [lags] Test Statistic Value Value Value ------------------------------------------------------------------------------ 3 -2.601 -2.587 -2.024 -1.711 2 -3.333 -2.587 -2.029 -1.715 1 -3.971 -2.587 -2.033 -1.719 Opt Lag (Ng-Perron seq t) = 3 with RMSE .0089982 Min SC = -9.312396 at lag 3 with RMSE .0089982 Min MAIC = -9.293625 at lag 3 with RMSE .0089982 AIC: yyy ~ I(2) with drift; SBC: yyy ~ I(1) with drift 4.3 Sample AC ac yyy /* slow linear decline =&gt; typical for DS with drift or TS process */ ac d.yyy /* quick decline =&gt; typical for CS process */ ac d2.yyy "],
["arma-modeling.html", "5 ARMA Modeling 5.1 ARMA Modeling: d.yyy 5.2 ARMA Modeling: d2.yyy", " 5 ARMA Modeling 5.1 ARMA Modeling: d.yyy 5.1.1 Identification tsline d.yyy /* standard error: Bartlett formula for MA(q), see classnotes 2.3.2 */ ac d.yyy, lags(24) level (95) pac d.yyy, lags(24) level(95)\t/* standard error: 1/sqrt(T) */ 5.1.2 Estimation &amp; Diagnostics (ARMA) 5.1.2.1 Estimation /* by default, Stata estimate ARIMA using exact MLE */ arima yyy, arima(2,1,2)\t/* mixed ARMA */ /* arima d.yyy, arima(2,0,2) */ /* arima d.yyy, ar(1 2) ma(1 2) */ /* arima d.yyy, ar(1/2) ma(1/2) */ (setting optimization to BHHH) Iteration 0: log likelihood = 650.59224 Iteration 1: log likelihood = 652.77714 Iteration 2: log likelihood = 653.83873 Iteration 3: log likelihood = 654.75285 Iteration 4: log likelihood = 654.97262 (switching optimization to BFGS) Iteration 5: log likelihood = 655.00383 Iteration 6: log likelihood = 655.2957 Iteration 7: log likelihood = 655.32887 Iteration 8: log likelihood = 655.34385 Iteration 9: log likelihood = 655.35017 Iteration 10: log likelihood = 655.35129 Iteration 11: log likelihood = 655.35132 Iteration 12: log likelihood = 655.35132 ARIMA regression Sample: 1957q2 - 2006q2 Number of obs = 197 Wald chi2(4) = 10747.63 Log likelihood = 655.3513 Prob &gt; chi2 = 0.0000 ------------------------------------------------------------------------------ | OPG D.yyy | Coef. Std. Err. z P&gt;|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- yyy | _cons | .0159815 .0023536 6.79 0.000 .0113686 .0205944 -------------+---------------------------------------------------------------- ARMA | ar | L1. | 1.30105 .3773679 3.45 0.001 .5614223 2.040677 L2. | -.3173635 .3583816 -0.89 0.376 -1.019778 .3850515 | ma | L1. | -1.02603 .3862259 -2.66 0.008 -1.783019 -.2690409 L2. | .1051773 .3123677 0.34 0.736 -.5070521 .7174066 -------------+---------------------------------------------------------------- /sigma | .0086786 .0003294 26.35 0.000 .008033 .0093242 ------------------------------------------------------------------------------ Note: The test of the variance against zero is one sided, and the two-sided confidence interval is truncated at zero. arima yyy, arima(1,1,1)\t/* keep */ (setting optimization to BHHH) Iteration 0: log likelihood = 649.89655 Iteration 1: log likelihood = 651.7709 Iteration 2: log likelihood = 651.96361 Iteration 3: log likelihood = 651.98377 Iteration 4: log likelihood = 651.98584 (switching optimization to BFGS) Iteration 5: log likelihood = 651.98615 Iteration 6: log likelihood = 651.98624 Iteration 7: log likelihood = 651.98625 ARIMA regression Sample: 1957q2 - 2006q2 Number of obs = 197 Wald chi2(2) = 130.83 Log likelihood = 651.9862 Prob &gt; chi2 = 0.0000 ------------------------------------------------------------------------------ | OPG D.yyy | Coef. Std. Err. z P&gt;|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- yyy | _cons | .0169337 .0013604 12.45 0.000 .0142673 .0196001 -------------+---------------------------------------------------------------- ARMA | ar | L1. | .7426586 .0944539 7.86 0.000 .5575322 .9277849 | ma | L1. | -.4471189 .1244703 -3.59 0.000 -.6910763 -.2031615 -------------+---------------------------------------------------------------- /sigma | .0088342 .0003134 28.19 0.000 .0082199 .0094484 ------------------------------------------------------------------------------ Note: The test of the variance against zero is one sided, and the two-sided confidence interval is truncated at zero. arima yyy, arima(1,1,2) (setting optimization to BHHH) Iteration 0: log likelihood = 650.6186 Iteration 1: log likelihood = 651.68917 Iteration 2: log likelihood = 651.99049 Iteration 3: log likelihood = 652.90482 Iteration 4: log likelihood = 654.60604 (switching optimization to BFGS) Iteration 5: log likelihood = 654.70836 Iteration 6: log likelihood = 654.7165 Iteration 7: log likelihood = 654.71683 Iteration 8: log likelihood = 654.71686 ARIMA regression Sample: 1957q2 - 2006q2 Number of obs = 197 Wald chi2(3) = 5210.50 Log likelihood = 654.7169 Prob &gt; chi2 = 0.0000 ------------------------------------------------------------------------------ | OPG D.yyy | Coef. Std. Err. z P&gt;|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- yyy | _cons | .0159279 .0023577 6.76 0.000 .0113068 .0205489 -------------+---------------------------------------------------------------- ARMA | ar | L1. | .9752008 .0236422 41.25 0.000 .9288629 1.021539 | ma | L1. | -.723271 .069351 -10.43 0.000 -.8591964 -.5873456 L2. | -.1543296 .0636119 -2.43 0.015 -.2790065 -.0296526 -------------+---------------------------------------------------------------- /sigma | .0087052 .0003273 26.59 0.000 .0080636 .0093468 ------------------------------------------------------------------------------ Note: The test of the variance against zero is one sided, and the two-sided confidence interval is truncated at zero. arima yyy, arima(2,1,1) (setting optimization to BHHH) Iteration 0: log likelihood = 650.28993 Iteration 1: log likelihood = 651.49754 Iteration 2: log likelihood = 651.68637 Iteration 3: log likelihood = 651.72782 Iteration 4: log likelihood = 651.73733 (switching optimization to BFGS) Iteration 5: log likelihood = 651.74101 Iteration 6: log likelihood = 651.9374 Iteration 7: log likelihood = 651.9374 (backed up) Iteration 8: log likelihood = 652.86225 Iteration 9: log likelihood = 652.86225 (backed up) Iteration 10: log likelihood = 653.04407 Iteration 11: log likelihood = 653.35297 Iteration 12: log likelihood = 653.50905 Iteration 13: log likelihood = 653.95694 Iteration 14: log likelihood = 654.49788 (switching optimization to BHHH) Iteration 15: log likelihood = 654.55222 Iteration 16: log likelihood = 655.04442 Iteration 17: log likelihood = 655.14238 Iteration 18: log likelihood = 655.1912 Iteration 19: log likelihood = 655.21255 (switching optimization to BFGS) Iteration 20: log likelihood = 655.21579 Iteration 21: log likelihood = 655.24536 Iteration 22: log likelihood = 655.24791 Iteration 23: log likelihood = 655.24805 Iteration 24: log likelihood = 655.24806 ARIMA regression Sample: 1957q2 - 2006q2 Number of obs = 197 Wald chi2(3) = 8084.35 Log likelihood = 655.2481 Prob &gt; chi2 = 0.0000 ------------------------------------------------------------------------------ | OPG D.yyy | Coef. Std. Err. z P&gt;|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- yyy | _cons | .0159552 .0023243 6.86 0.000 .0113996 .0205108 -------------+---------------------------------------------------------------- ARMA | ar | L1. | 1.184938 .0880645 13.46 0.000 1.012335 1.357541 L2. | -.2040168 .0744351 -2.74 0.006 -.3499069 -.0581268 | ma | L1. | -.9065238 .0689221 -13.15 0.000 -1.041609 -.771439 -------------+---------------------------------------------------------------- /sigma | .0086828 .0003235 26.84 0.000 .0080488 .0093168 ------------------------------------------------------------------------------ Note: The test of the variance against zero is one sided, and the two-sided confidence interval is truncated at zero. 5.1.2.2 Diagnostics arima yyy, arima(1,1,1) cap drop res predict res, residuals tsline res corrgram res, lags(24) -1 0 1 -1 0 1 LAG AC PAC Q Prob&gt;Q [Autocorrelation] [Partial Autocor] ------------------------------------------------------------------------------- 1 0.0101 0.0101 .02046 0.8863 | | 2 0.0086 0.0085 .03543 0.9824 | | 3 -0.0860 -0.0864 1.531 0.6751 | | 4 0.0262 0.0260 1.6706 0.7960 | | 5 -0.0828 -0.0830 3.069 0.6893 | | 6 0.0416 0.0343 3.4246 0.7540 | | 7 0.0270 0.0359 3.5748 0.8272 | | 8 -0.0889 -0.1044 5.2134 0.7345 | | 9 0.0750 0.0902 6.3851 0.7008 | | 10 0.1742 0.1781 12.75 0.2380 |- |- 11 0.2078 0.2109 21.853 0.0255 |- |- 12 0.0006 0.0274 21.853 0.0392 | | 13 0.0223 0.0214 21.959 0.0560 | | 14 0.0354 0.0805 22.228 0.0740 | | 15 -0.0480 -0.0535 22.724 0.0902 | | 16 0.1040 0.1383 25.067 0.0686 | |- 17 -0.0316 -0.0420 25.285 0.0885 | | 18 0.0984 0.1094 27.404 0.0717 | | 19 -0.0248 0.0148 27.54 0.0927 | | 20 0.1464 0.0488 32.287 0.0403 |- | 21 0.0369 0.0551 32.591 0.0510 | | 22 0.0540 -0.0050 33.243 0.0585 | | 23 -0.0815 -0.0544 34.739 0.0552 | | 24 0.0233 0.0066 34.863 0.0705 | | wntestq res, lags(24) /* Q-tests for white noise */ Portmanteau test for white noise --------------------------------------- Portmanteau (Q) statistic = 34.8627 Prob &gt; chi2(24) = 0.0705 armaroots /* check the stationarity &amp; invertibilty conditions, common AR &amp; MA roots */ 5.1.3 Estimation &amp; Diagnostics (Pure AR) 5.1.3.1 Estimation arima d.yyy, ar(1) (setting optimization to BHHH) Iteration 0: log likelihood = 649.42866 Iteration 1: log likelihood = 649.43048 Iteration 2: log likelihood = 649.4306 Iteration 3: log likelihood = 649.43061 ARIMA regression Sample: 1957q2 - 2006q2 Number of obs = 197 Wald chi2(1) = 43.01 Log likelihood = 649.4306 Prob &gt; chi2 = 0.0000 ------------------------------------------------------------------------------ | OPG D.yyy | Coef. Std. Err. z P&gt;|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- yyy | _cons | .0170224 .0010367 16.42 0.000 .0149905 .0190543 -------------+---------------------------------------------------------------- ARMA | ar | L1. | .3733012 .056924 6.56 0.000 .2617322 .4848701 -------------+---------------------------------------------------------------- /sigma | .008951 .0003111 28.77 0.000 .0083412 .0095608 ------------------------------------------------------------------------------ Note: The test of the variance against zero is one sided, and the two-sided confidence interval is truncated at zero. arima d.yyy, ar(1/2) /* ? */ (setting optimization to BHHH) Iteration 0: log likelihood = 651.74694 Iteration 1: log likelihood = 651.74843 Iteration 2: log likelihood = 651.74851 Iteration 3: log likelihood = 651.74853 Iteration 4: log likelihood = 651.74853 ARIMA regression Sample: 1957q2 - 2006q2 Number of obs = 197 Wald chi2(2) = 53.25 Log likelihood = 651.7485 Prob &gt; chi2 = 0.0000 ------------------------------------------------------------------------------ | OPG D.yyy | Coef. Std. Err. z P&gt;|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- yyy | _cons | .0170066 .001215 14.00 0.000 .0146252 .019388 -------------+---------------------------------------------------------------- ARMA | ar | L1. | .3157918 .0574913 5.49 0.000 .203111 .4284727 L2. | .152608 .0582 2.62 0.009 .0385381 .2666779 -------------+---------------------------------------------------------------- /sigma | .0088463 .0003035 29.14 0.000 .0082514 .0094412 ------------------------------------------------------------------------------ Note: The test of the variance against zero is one sided, and the two-sided confidence interval is truncated at zero. arima d.yyy, ar(1/11) test l3.ar l4.ar l5.ar l6.ar l7.ar l9.ar (setting optimization to BHHH) Iteration 0: log likelihood = 663.22484 Iteration 1: log likelihood = 664.72872 Iteration 2: log likelihood = 664.92201 Iteration 3: log likelihood = 664.94781 Iteration 4: log likelihood = 664.95119 (switching optimization to BFGS) Iteration 5: log likelihood = 664.99621 Iteration 6: log likelihood = 664.99925 Iteration 7: log likelihood = 664.99975 Iteration 8: log likelihood = 664.99981 Iteration 9: log likelihood = 664.99983 ARIMA regression Sample: 1957q2 - 2006q2 Number of obs = 197 Wald chi2(11) = 127.19 Log likelihood = 664.9998 Prob &gt; chi2 = 0.0000 ------------------------------------------------------------------------------ | OPG D.yyy | Coef. Std. Err. z P&gt;|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- yyy | _cons | .016381 .0022934 7.14 0.000 .0118861 .0208759 -------------+---------------------------------------------------------------- ARMA | ar | L1. | .2438429 .0648299 3.76 0.000 .1167786 .3709072 L2. | .1131205 .0635698 1.78 0.075 -.011474 .2377151 L3. | -.0329492 .0721054 -0.46 0.648 -.1742732 .1083748 L4. | .0902171 .0644667 1.40 0.162 -.0361353 .2165695 L5. | -.0766611 .0705376 -1.09 0.277 -.2149122 .0615901 L6. | .0665104 .0822563 0.81 0.419 -.0947089 .2277298 L7. | .0287261 .0900902 0.32 0.750 -.1478474 .2052996 L8. | -.1151417 .0598476 -1.92 0.054 -.2324408 .0021574 L9. | .1079984 .0723101 1.49 0.135 -.0337266 .2497235 L10. | .1838683 .065891 2.79 0.005 .0547244 .3130122 L11. | .1675329 .0712291 2.35 0.019 .0279263 .3071394 -------------+---------------------------------------------------------------- /sigma | .0082415 .0003887 21.20 0.000 .0074796 .0090035 ------------------------------------------------------------------------------ Note: The test of the variance against zero is one sided, and the two-sided confidence interval is truncated at zero. ( 1) [ARMA]L3.ar = 0 ( 2) [ARMA]L4.ar = 0 ( 3) [ARMA]L5.ar = 0 ( 4) [ARMA]L6.ar = 0 ( 5) [ARMA]L7.ar = 0 ( 6) [ARMA]L9.ar = 0 chi2( 6) = 4.55 Prob &gt; chi2 = 0.6032 arima d.yyy, ar(1 2 8 10 11) (setting optimization to BHHH) Iteration 0: log likelihood = 661.14929 Iteration 1: log likelihood = 662.30526 Iteration 2: log likelihood = 662.42793 Iteration 3: log likelihood = 662.4608 Iteration 4: log likelihood = 662.47017 (switching optimization to BFGS) Iteration 5: log likelihood = 662.47255 Iteration 6: log likelihood = 662.47341 Iteration 7: log likelihood = 662.47342 ARIMA regression Sample: 1957q2 - 2006q2 Number of obs = 197 Wald chi2(5) = 119.37 Log likelihood = 662.4734 Prob &gt; chi2 = 0.0000 ------------------------------------------------------------------------------ | OPG D.yyy | Coef. Std. Err. z P&gt;|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- yyy | _cons | .0165672 .001834 9.03 0.000 .0129726 .0201619 -------------+---------------------------------------------------------------- ARMA | ar | L1. | .2250604 .0589636 3.82 0.000 .1094939 .340627 L2. | .1352164 .0601752 2.25 0.025 .0172751 .2531577 L8. | -.0621413 .0548113 -1.13 0.257 -.1695694 .0452868 L10. | .2230326 .0596781 3.74 0.000 .1060657 .3399996 L11. | .1893455 .0654916 2.89 0.004 .0609843 .3177068 -------------+---------------------------------------------------------------- /sigma | .0083501 .000349 23.92 0.000 .007666 .0090342 ------------------------------------------------------------------------------ Note: The test of the variance against zero is one sided, and the two-sided confidence interval is truncated at zero. arima d.yyy, ar(1 2 10 11) (setting optimization to BHHH) Iteration 0: log likelihood = 660.80059 Iteration 1: log likelihood = 661.9042 Iteration 2: log likelihood = 662.01899 Iteration 3: log likelihood = 662.05047 Iteration 4: log likelihood = 662.0593 (switching optimization to BFGS) Iteration 5: log likelihood = 662.06188 Iteration 6: log likelihood = 662.06281 Iteration 7: log likelihood = 662.06281 ARIMA regression Sample: 1957q2 - 2006q2 Number of obs = 197 Wald chi2(4) = 128.69 Log likelihood = 662.0628 Prob &gt; chi2 = 0.0000 ------------------------------------------------------------------------------ | OPG D.yyy | Coef. Std. Err. z P&gt;|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- yyy | _cons | .0164744 .0020063 8.21 0.000 .0125421 .0204067 -------------+---------------------------------------------------------------- ARMA | ar | L1. | .2229229 .0593501 3.76 0.000 .1065989 .339247 L2. | .1274565 .0596481 2.14 0.033 .0105484 .2443645 L10. | .2067813 .0584423 3.54 0.000 .0922366 .3213261 L11. | .1857449 .0658386 2.82 0.005 .0567036 .3147863 -------------+---------------------------------------------------------------- /sigma | .0083693 .0003483 24.03 0.000 .0076867 .0090519 ------------------------------------------------------------------------------ Note: The test of the variance against zero is one sided, and the two-sided confidence interval is truncated at zero. 5.1.3.2 Diagnostics arima d.yyy, ar(1 2 10 11) cap drop res predict res, residuals tsline res corrgram res, lags(24) -1 0 1 -1 0 1 LAG AC PAC Q Prob&gt;Q [Autocorrelation] [Partial Autocor] ------------------------------------------------------------------------------- 1 0.0130 0.0130 .03374 0.8543 | | 2 0.0045 0.0043 .0379 0.9812 | | 3 -0.0314 -0.0313 .23713 0.9714 | | 4 0.0407 0.0412 .57351 0.9660 | | 5 -0.0759 -0.0764 1.7484 0.8827 | | 6 0.0432 0.0415 2.1311 0.9073 | | 7 0.0311 0.0363 2.3306 0.9393 | | 8 -0.0967 -0.1042 4.2717 0.8318 | | 9 0.0599 0.0707 5.0192 0.8326 | | 10 -0.0340 -0.0416 5.2617 0.8730 | | 11 -0.0155 -0.0203 5.3126 0.9151 | | 12 -0.0590 -0.0408 6.0504 0.9135 | | 13 0.0143 -0.0101 6.094 0.9427 | | 14 0.0151 0.0414 6.1427 0.9628 | | 15 -0.0450 -0.0655 6.5795 0.9683 | | 16 0.1082 0.1229 9.114 0.9086 | | 17 -0.0378 -0.0428 9.4259 0.9259 | | 18 0.1111 0.1084 12.128 0.8405 | | 19 0.0124 0.0387 12.162 0.8786 | | 20 0.1268 0.0806 15.726 0.7335 |- | 21 -0.0257 0.0346 15.873 0.7767 | | 22 0.0191 -0.0310 15.955 0.8181 | | 23 -0.0888 -0.0855 17.733 0.7718 | | 24 0.0057 0.0122 17.74 0.8154 | | wntestq res, lags(24) Portmanteau test for white noise --------------------------------------- Portmanteau (Q) statistic = 17.7404 Prob &gt; chi2(24) = 0.8154 armaroots 5.1.4 Estimation &amp; Diagnostics (Pure MA) 5.1.4.1 Estimation arima d.yyy, ma(1/2) (setting optimization to BHHH) Iteration 0: log likelihood = 649.86494 Iteration 1: log likelihood = 650.03192 Iteration 2: log likelihood = 650.05111 Iteration 3: log likelihood = 650.05378 Iteration 4: log likelihood = 650.05426 (switching optimization to BFGS) Iteration 5: log likelihood = 650.05436 Iteration 6: log likelihood = 650.05438 ARIMA regression Sample: 1957q2 - 2006q2 Number of obs = 197 Wald chi2(2) = 34.99 Log likelihood = 650.0544 Prob &gt; chi2 = 0.0000 ------------------------------------------------------------------------------ | OPG D.yyy | Coef. Std. Err. z P&gt;|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- yyy | _cons | .0170418 .0009994 17.05 0.000 .0150831 .0190006 -------------+---------------------------------------------------------------- ARMA | ma | L1. | .3175348 .0561098 5.66 0.000 .2075616 .4275081 L2. | .1970972 .0587295 3.36 0.001 .0819894 .3122049 -------------+---------------------------------------------------------------- /sigma | .008923 .0003074 29.03 0.000 .0083206 .0095254 ------------------------------------------------------------------------------ Note: The test of the variance against zero is one sided, and the two-sided confidence interval is truncated at zero. arima d.yyy, ma(1/11) test l3.ar l4.ar l5.ar l6.ar l7.ar l9.ar (setting optimization to BHHH) Iteration 0: log likelihood = 660.37262 Iteration 1: log likelihood = 661.42755 Iteration 2: log likelihood = 661.68345 Iteration 3: log likelihood = 661.69705 Iteration 4: log likelihood = 661.71826 (switching optimization to BFGS) Iteration 5: log likelihood = 661.87331 Iteration 6: log likelihood = 661.88088 Iteration 7: log likelihood = 661.88278 Iteration 8: log likelihood = 661.88288 Iteration 9: log likelihood = 661.88293 ARIMA regression Sample: 1957q2 - 2006q2 Number of obs = 197 Wald chi2(11) = 49.19 Log likelihood = 661.8829 Prob &gt; chi2 = 0.0000 ------------------------------------------------------------------------------ | OPG D.yyy | Coef. Std. Err. z P&gt;|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- yyy | _cons | .0168882 .001356 12.45 0.000 .0142304 .0195459 -------------+---------------------------------------------------------------- ARMA | ma | L1. | .2891741 .0631211 4.58 0.000 .1654589 .4128893 L2. | .1830966 .0772815 2.37 0.018 .0316276 .3345655 L3. | .0449302 .0742129 0.61 0.545 -.1005245 .1903848 L4. | .179056 .0653367 2.74 0.006 .0509985 .3071135 L5. | -.0157297 .0698791 -0.23 0.822 -.1526902 .1212308 L6. | .0753758 .0823752 0.92 0.360 -.0860766 .2368281 L7. | .0098652 .0845196 0.12 0.907 -.1557902 .1755207 L8. | -.0474722 .075853 -0.63 0.531 -.1961413 .1011968 L9. | .0187734 .0728795 0.26 0.797 -.1240677 .1616146 L10. | .1631258 .0739421 2.21 0.027 .018202 .3080496 L11. | .2618914 .0838967 3.12 0.002 .0974569 .426326 -------------+---------------------------------------------------------------- /sigma | .0083804 .0003413 24.56 0.000 .0077115 .0090492 ------------------------------------------------------------------------------ Note: The test of the variance against zero is one sided, and the two-sided confidence interval is truncated at zero. l3.ar not found r(111); end of do-file r(111); arima d.yyy, ma(1 2 4 10 11) /* keep */ (setting optimization to BHHH) Iteration 0: log likelihood = 660.10946 Iteration 1: log likelihood = 660.45577 Iteration 2: log likelihood = 660.51453 Iteration 3: log likelihood = 660.52955 Iteration 4: log likelihood = 660.53352 (switching optimization to BFGS) Iteration 5: log likelihood = 660.5347 Iteration 6: log likelihood = 660.53524 Iteration 7: log likelihood = 660.53526 ARIMA regression Sample: 1957q2 - 2006q2 Number of obs = 197 Wald chi2(5) = 58.32 Log likelihood = 660.5353 Prob &gt; chi2 = 0.0000 ------------------------------------------------------------------------------ | OPG D.yyy | Coef. Std. Err. z P&gt;|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- yyy | _cons | .0168866 .0012613 13.39 0.000 .0144144 .0193588 -------------+---------------------------------------------------------------- ARMA | ma | L1. | .2919739 .0586594 4.98 0.000 .1770036 .4069442 L2. | .146004 .0698232 2.09 0.037 .009153 .282855 L4. | .1824151 .0615452 2.96 0.003 .0617886 .3030415 L10. | .1718678 .063352 2.71 0.007 .0477002 .2960354 L11. | .2708313 .076412 3.54 0.000 .1210665 .4205961 -------------+---------------------------------------------------------------- /sigma | .0084366 .0003307 25.51 0.000 .0077885 .0090847 ------------------------------------------------------------------------------ Note: The test of the variance against zero is one sided, and the two-sided confidence interval is truncated at zero. 5.1.4.2 Diagnostics arima d.yyy, ma(1 2 4 10 11) cap drop res predict res, residuals tsline res corrgram res, lags(24) -1 0 1 -1 0 1 LAG AC PAC Q Prob&gt;Q [Autocorrelation] [Partial Autocor] ------------------------------------------------------------------------------- 1 0.0022 0.0022 .00101 0.9747 | | 2 0.0610 0.0611 .74976 0.6874 | | 3 0.0556 0.0553 1.375 0.7114 | | 4 -0.0601 -0.0611 2.1087 0.7158 | | 5 -0.0145 -0.0215 2.1514 0.8278 | | 6 0.0974 0.1038 4.0997 0.6632 | | 7 0.0300 0.0457 4.286 0.7463 | | 8 -0.0400 -0.0564 4.6187 0.7974 | | 9 0.0779 0.0573 5.8826 0.7516 | | 10 0.0048 0.0211 5.8874 0.8246 | | 11 0.0176 0.0154 5.9528 0.8765 | | 12 0.1098 0.0927 8.5084 0.7442 | | 13 0.0718 0.0759 9.6082 0.7256 | | 14 0.0617 0.0540 10.423 0.7307 | | 15 0.0127 -0.0210 10.457 0.7900 | | 16 0.0896 0.0828 12.197 0.7303 | | 17 -0.0238 -0.0142 12.321 0.7803 | | 18 0.1115 0.0949 15.044 0.6589 | | 19 0.0302 0.0139 15.246 0.7069 | | 20 0.1282 0.1256 18.887 0.5292 |- |- 21 0.0562 0.0536 19.591 0.5473 | | 22 0.0634 0.0320 20.492 0.5523 | | 23 -0.0728 -0.0983 21.685 0.5393 | | 24 0.0337 0.0260 21.943 0.5827 | | wntestq res, lags(24) Portmanteau test for white noise --------------------------------------- Portmanteau (Q) statistic = 21.9428 Prob &gt; chi2(24) = 0.5827 armaroots 5.1.5 Estimation &amp; Diagnostics (Additive seasonal ARIMA) arima d.yyy, ar(1 4) ma(1 4) (setting optimization to BHHH) Iteration 0: log likelihood = 649.57134 Iteration 1: log likelihood = 652.00647 Iteration 2: log likelihood = 652.70584 Iteration 3: log likelihood = 654.03984 Iteration 4: log likelihood = 655.16373 (switching optimization to BFGS) Iteration 5: log likelihood = 655.20524 Iteration 6: log likelihood = 655.20653 Iteration 7: log likelihood = 655.20731 Iteration 8: log likelihood = 655.20744 Iteration 9: log likelihood = 655.20744 ARIMA regression Sample: 1957q2 - 2006q2 Number of obs = 197 Wald chi2(4) = 1272.63 Log likelihood = 655.2074 Prob &gt; chi2 = 0.0000 ------------------------------------------------------------------------------ | OPG D.yyy | Coef. Std. Err. z P&gt;|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- yyy | _cons | .0159353 .0024205 6.58 0.000 .0111913 .0206793 -------------+---------------------------------------------------------------- ARMA | ar | L1. | .6212828 .1257041 4.94 0.000 .3749072 .8676584 L4. | .3288232 .1227238 2.68 0.007 .0882891 .5693574 | ma | L1. | -.3816978 .1451447 -2.63 0.009 -.6661761 -.0972194 L4. | -.3654086 .1288975 -2.83 0.005 -.618043 -.1127742 -------------+---------------------------------------------------------------- /sigma | .0086828 .0003262 26.62 0.000 .0080434 .0093222 ------------------------------------------------------------------------------ Note: The test of the variance against zero is one sided, and the two-sided confidence interval is truncated at zero. cap drop res predict res, residuals tsline res corrgram res, lags(24) -1 0 1 -1 0 1 LAG AC PAC Q Prob&gt;Q [Autocorrelation] [Partial Autocor] ------------------------------------------------------------------------------- 1 0.0215 0.0215 .09214 0.7615 | | 2 0.0342 0.0339 .32795 0.8488 | | 3 -0.0738 -0.0756 1.43 0.6985 | | 4 0.0430 0.0445 1.8056 0.7715 | | 5 -0.1649 -0.1632 7.3565 0.1954 -| -| 6 -0.0400 -0.0458 7.6849 0.2621 | | 7 -0.0324 -0.0133 7.9021 0.3413 | | 8 -0.1126 -0.1369 10.53 0.2298 | -| 9 0.0244 0.0429 10.654 0.3002 | | 10 0.1299 0.1251 14.194 0.1643 |- |- 11 0.1609 0.1476 19.65 0.0504 |- |- 12 -0.0162 -0.0192 19.705 0.0729 | | 13 0.0059 -0.0337 19.713 0.1026 | | 14 0.0250 0.0343 19.847 0.1350 | | 15 -0.0752 -0.0860 21.066 0.1347 | | 16 0.0697 0.1379 22.117 0.1394 | |- 17 -0.0580 -0.0489 22.85 0.1542 | | 18 0.0779 0.0924 24.18 0.1492 | | 19 -0.0533 -0.0024 24.805 0.1671 | | 20 0.1247 0.0293 28.251 0.1036 | | 21 0.0142 0.0597 28.296 0.1320 | | 22 0.0386 -0.0121 28.63 0.1557 | | 23 -0.0927 -0.0378 30.567 0.1338 | | 24 0.0184 0.0230 30.644 0.1643 | | wntestq res, lags(24) Portmanteau test for white noise --------------------------------------- Portmanteau (Q) statistic = 30.6440 Prob &gt; chi2(24) = 0.1643 armaroots 5.1.6 Estimation &amp; Diagnostics (Multiplicative seasonal ARIMA) 5.1.6.1 ARMA with seasonal components arima yyy, arima(1,1,1) sarima(1,0,1,4) /* arima d.yyy, ar(1) ma(1) mar(1,4) mma(1,4)\t*/ (setting optimization to BHHH) Iteration 0: log likelihood = 649.89655 (not concave) Iteration 1: log likelihood = 651.86926 Iteration 2: log likelihood = 652.58909 Iteration 3: log likelihood = 652.72551 Iteration 4: log likelihood = 652.75109 (switching optimization to BFGS) Iteration 5: log likelihood = 652.76074 Iteration 6: log likelihood = 652.76483 Iteration 7: log likelihood = 652.76508 Iteration 8: log likelihood = 652.76509 ARIMA regression Sample: 1957q2 - 2006q2 Number of obs = 197 Wald chi2(4) = 90.80 Log likelihood = 652.7651 Prob &gt; chi2 = 0.0000 ------------------------------------------------------------------------------ | OPG D.yyy | Coef. Std. Err. z P&gt;|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- yyy | _cons | .0169608 .0012976 13.07 0.000 .0144175 .019504 -------------+---------------------------------------------------------------- ARMA | ar | L1. | .6313137 .1293726 4.88 0.000 .377748 .8848794 | ma | L1. | -.3047184 .1524066 -2.00 0.046 -.6034298 -.0060071 -------------+---------------------------------------------------------------- ARMA4 | ar | L1. | -.3287778 .5762388 -0.57 0.568 -1.458185 .8006295 | ma | L1. | .4299363 .5597762 0.77 0.442 -.6672049 1.527078 -------------+---------------------------------------------------------------- /sigma | .0087986 .0003159 27.85 0.000 .0081794 .0094178 ------------------------------------------------------------------------------ Note: The test of the variance against zero is one sided, and the two-sided confidence interval is truncated at zero. arima yyy, arima(1,1,1) mma(1,4) /* keep */ (setting optimization to BHHH) Iteration 0: log likelihood = 649.89655 Iteration 1: log likelihood = 652.10292 Iteration 2: log likelihood = 652.48319 Iteration 3: log likelihood = 652.52543 Iteration 4: log likelihood = 652.52704 (switching optimization to BFGS) Iteration 5: log likelihood = 652.5272 Iteration 6: log likelihood = 652.52722 ARIMA regression Sample: 1957q2 - 2006q2 Number of obs = 197 Wald chi2(3) = 80.16 Log likelihood = 652.5272 Prob &gt; chi2 = 0.0000 ------------------------------------------------------------------------------ | OPG D.yyy | Coef. Std. Err. z P&gt;|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- yyy | _cons | .0169485 .0012989 13.05 0.000 .0144027 .0194944 -------------+---------------------------------------------------------------- ARMA | ar | L1. | .607155 .134004 4.53 0.000 .3445121 .8697979 | ma | L1. | -.2784244 .1554106 -1.79 0.073 -.5830235 .0261747 -------------+---------------------------------------------------------------- ARMA4 | ma | L1. | .1095105 .0644338 1.70 0.089 -.0167773 .2357984 -------------+---------------------------------------------------------------- /sigma | .0088095 .0003117 28.26 0.000 .0081985 .0094204 ------------------------------------------------------------------------------ Note: The test of the variance against zero is one sided, and the two-sided confidence interval is truncated at zero. arima yyy, arima(1,1,1) mar(1,4) (setting optimization to BHHH) Iteration 0: log likelihood = 649.89655 Iteration 1: log likelihood = 652.02911 Iteration 2: log likelihood = 652.34947 Iteration 3: log likelihood = 652.37937 Iteration 4: log likelihood = 652.38529 (switching optimization to BFGS) Iteration 5: log likelihood = 652.38654 Iteration 6: log likelihood = 652.38687 Iteration 7: log likelihood = 652.38687 ARIMA regression Sample: 1957q2 - 2006q2 Number of obs = 197 Wald chi2(3) = 81.62 Log likelihood = 652.3869 Prob &gt; chi2 = 0.0000 ------------------------------------------------------------------------------ | OPG D.yyy | Coef. Std. Err. z P&gt;|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- yyy | _cons | .016949 .0013079 12.96 0.000 .0143856 .0195125 -------------+---------------------------------------------------------------- ARMA | ar | L1. | .6229129 .1316006 4.73 0.000 .3649806 .8808452 | ma | L1. | -.2986446 .1541153 -1.94 0.053 -.6007051 .0034159 -------------+---------------------------------------------------------------- ARMA4 | ar | L1. | .0880324 .0651807 1.35 0.177 -.0397194 .2157843 -------------+---------------------------------------------------------------- /sigma | .0088165 .000311 28.35 0.000 .0082069 .0094261 ------------------------------------------------------------------------------ Note: The test of the variance against zero is one sided, and the two-sided confidence interval is truncated at zero. arima yyy, arima(1,1,1) mma(1,4) cap drop res predict res, residuals tsline res corrgram res, lags(24) -1 0 1 -1 0 1 LAG AC PAC Q Prob&gt;Q [Autocorrelation] [Partial Autocor] ------------------------------------------------------------------------------- 1 -0.0094 -0.0094 .01773 0.8941 | | 2 0.0380 0.0381 .30823 0.8572 | | 3 -0.0463 -0.0465 .74189 0.8633 | | 4 -0.0265 -0.0298 .88439 0.9268 | | 5 -0.0597 -0.0575 1.613 0.8997 | | 6 0.0523 0.0514 2.1747 0.9029 | | 7 0.0388 0.0468 2.4851 0.9282 | | 8 -0.0633 -0.0707 3.3158 0.9130 | | 9 0.0925 0.0901 5.1012 0.8254 | | 10 0.1641 0.1804 10.746 0.3776 |- |- 11 0.2127 0.2308 20.285 0.0416 |- |- 12 0.0034 0.0151 20.287 0.0618 | | 13 0.0372 0.0245 20.581 0.0816 | | 14 0.0323 0.0797 20.805 0.1067 | | 15 -0.0533 -0.0406 21.417 0.1240 | | 16 0.1125 0.1242 24.156 0.0861 | | 17 -0.0297 -0.0450 24.349 0.1103 | | 18 0.1077 0.1085 26.89 0.0811 | | 19 -0.0075 0.0096 26.902 0.1069 | | 20 0.1427 0.0570 31.41 0.0500 |- | 21 0.0364 0.0350 31.704 0.0627 | | 22 0.0585 0.0042 32.47 0.0697 | | 23 -0.0736 -0.0618 33.689 0.0698 | | 24 0.0218 -0.0052 33.796 0.0884 | | wntestq res, lags(24) Portmanteau test for white noise --------------------------------------- Portmanteau (Q) statistic = 33.7963 Prob &gt; chi2(24) = 0.0884 armaroots 5.1.6.2 AR with seasonal components arima yyy, arima(2,1,0) sarima(1,0,1,4) (setting optimization to BHHH) Iteration 0: log likelihood = 651.74694 (not concave) Iteration 1: log likelihood = 652.56457 Iteration 2: log likelihood = 652.71036 Iteration 3: log likelihood = 652.9278 Iteration 4: log likelihood = 652.9594 (switching optimization to BFGS) Iteration 5: log likelihood = 652.96293 Iteration 6: log likelihood = 652.96521 Iteration 7: log likelihood = 652.96554 Iteration 8: log likelihood = 652.96558 ARIMA regression Sample: 1957q2 - 2006q2 Number of obs = 197 Wald chi2(4) = 58.90 Log likelihood = 652.9656 Prob &gt; chi2 = 0.0000 ------------------------------------------------------------------------------ | OPG D.yyy | Coef. Std. Err. z P&gt;|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- yyy | _cons | .0169804 .0012789 13.28 0.000 .0144738 .0194871 -------------+---------------------------------------------------------------- ARMA | ar | L1. | .3219026 .0572563 5.62 0.000 .2096824 .4341228 L2. | .1283119 .0598028 2.15 0.032 .0111006 .2455233 -------------+---------------------------------------------------------------- ARMA4 | ar | L1. | -.2944317 .538507 -0.55 0.585 -1.349886 .7610226 | ma | L1. | .4076916 .5250834 0.78 0.437 -.6214529 1.436836 -------------+---------------------------------------------------------------- /sigma | .00879 .0003137 28.02 0.000 .0081751 .0094048 ------------------------------------------------------------------------------ Note: The test of the variance against zero is one sided, and the two-sided confidence interval is truncated at zero. arima yyy, arima(2,1,0) mma(1,4) /* keep */ (setting optimization to BHHH) Iteration 0: log likelihood = 651.74694 Iteration 1: log likelihood = 652.61302 Iteration 2: log likelihood = 652.71036 Iteration 3: log likelihood = 652.72799 Iteration 4: log likelihood = 652.73179 (switching optimization to BFGS) Iteration 5: log likelihood = 652.73251 Iteration 6: log likelihood = 652.73263 Iteration 7: log likelihood = 652.73263 ARIMA regression Sample: 1957q2 - 2006q2 Number of obs = 197 Wald chi2(3) = 54.75 Log likelihood = 652.7326 Prob &gt; chi2 = 0.0000 ------------------------------------------------------------------------------ | OPG D.yyy | Coef. Std. Err. z P&gt;|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- yyy | _cons | .0169633 .0012929 13.12 0.000 .0144293 .0194974 -------------+---------------------------------------------------------------- ARMA | ar | L1. | .3221785 .0575096 5.60 0.000 .2094617 .4348953 L2. | .1199752 .0583889 2.05 0.040 .0055351 .2344153 -------------+---------------------------------------------------------------- ARMA4 | ma | L1. | .119089 .059717 1.99 0.046 .0020458 .2361322 -------------+---------------------------------------------------------------- /sigma | .0088005 .0003095 28.43 0.000 .0081939 .0094072 ------------------------------------------------------------------------------ Note: The test of the variance against zero is one sided, and the two-sided confidence interval is truncated at zero. cap drop res predict res, residuals tsline res corrgram res, lags(24) -1 0 1 -1 0 1 LAG AC PAC Q Prob&gt;Q [Autocorrelation] [Partial Autocor] ------------------------------------------------------------------------------- 1 -0.0009 -0.0009 .00016 0.9900 | | 2 0.0118 0.0118 .028 0.9861 | | 3 -0.0256 -0.0258 .16079 0.9837 | | 4 -0.0263 -0.0271 .30083 0.9898 | | 5 -0.0516 -0.0521 .84551 0.9740 | | 6 0.0615 0.0613 1.6227 0.9509 | | 7 0.0433 0.0486 2.0096 0.9593 | | 8 -0.0630 -0.0658 2.8317 0.9445 | | 9 0.0888 0.0874 4.4764 0.8774 | | 10 0.1700 0.1807 10.534 0.3950 |- |- 11 0.2117 0.2340 19.98 0.0456 |- |- 12 0.0018 0.0143 19.98 0.0675 | | 13 0.0388 0.0334 20.301 0.0879 | | 14 0.0340 0.0710 20.549 0.1138 | | 15 -0.0483 -0.0364 21.052 0.1352 | | 16 0.1119 0.1203 23.766 0.0947 | | 17 -0.0220 -0.0481 23.871 0.1230 | | 18 0.1022 0.1109 26.159 0.0962 | | 19 -0.0016 0.0032 26.159 0.1258 | | 20 0.1381 0.0602 30.38 0.0639 |- | 21 0.0436 0.0335 30.803 0.0770 | | 22 0.0562 0.0056 31.51 0.0861 | | 23 -0.0723 -0.0643 32.687 0.0867 | | 24 0.0228 -0.0073 32.805 0.1083 | | wntestq res, lags(24) Portmanteau test for white noise --------------------------------------- Portmanteau (Q) statistic = 32.8049 Prob &gt; chi2(24) = 0.1083 armaroots arima yyy, arima(2,1,0) mar(1,4) /* keep */ (setting optimization to BHHH) Iteration 0: log likelihood = 651.74694 Iteration 1: log likelihood = 652.47638 Iteration 2: log likelihood = 652.54234 Iteration 3: log likelihood = 652.55606 Iteration 4: log likelihood = 652.5595 (switching optimization to BFGS) Iteration 5: log likelihood = 652.56038 Iteration 6: log likelihood = 652.56068 Iteration 7: log likelihood = 652.56069 ARIMA regression Sample: 1957q2 - 2006q2 Number of obs = 197 Wald chi2(3) = 52.84 Log likelihood = 652.5607 Prob &gt; chi2 = 0.0000 ------------------------------------------------------------------------------ | OPG D.yyy | Coef. Std. Err. z P&gt;|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- yyy | _cons | .0169659 .0012928 13.12 0.000 .0144321 .0194997 -------------+---------------------------------------------------------------- ARMA | ar | L1. | .3197828 .0575683 5.55 0.000 .2069509 .4326147 L2. | .1224327 .0582824 2.10 0.036 .0082013 .2366641 -------------+---------------------------------------------------------------- ARMA4 | ar | L1. | .1001421 .0604763 1.66 0.098 -.0183893 .2186735 -------------+---------------------------------------------------------------- /sigma | .0088086 .0003082 28.58 0.000 .0082046 .0094126 ------------------------------------------------------------------------------ Note: The test of the variance against zero is one sided, and the two-sided confidence interval is truncated at zero. cap drop res predict res, residuals tsline res corrgram res, lags(24) -1 0 1 -1 0 1 LAG AC PAC Q Prob&gt;Q [Autocorrelation] [Partial Autocor] ------------------------------------------------------------------------------- 1 -0.0010 -0.0011 .00022 0.9882 | | 2 0.0084 0.0085 .01453 0.9928 | | 3 -0.0272 -0.0273 .16354 0.9832 | | 4 -0.0094 -0.0102 .18145 0.9961 | | 5 -0.0504 -0.0506 .69986 0.9830 | | 6 0.0643 0.0631 1.5475 0.9563 | | 7 0.0470 0.0523 2.0037 0.9596 | | 8 -0.0769 -0.0793 3.2298 0.9191 | | 9 0.0885 0.0888 4.8617 0.8462 | | 10 0.1711 0.1802 10.997 0.3578 |- |- 11 0.2121 0.2326 20.475 0.0392 |- |- 12 0.0017 0.0171 20.475 0.0586 | | 13 0.0400 0.0318 20.815 0.0767 | | 14 0.0372 0.0709 21.112 0.0988 | | 15 -0.0438 -0.0390 21.526 0.1209 | | 16 0.1143 0.1217 24.357 0.0820 | | 17 -0.0219 -0.0485 24.461 0.1074 | | 18 0.1011 0.1118 26.701 0.0848 | | 19 -0.0067 0.0049 26.71 0.1116 | | 20 0.1401 0.0566 31.058 0.0544 |- | 21 0.0438 0.0360 31.485 0.0660 | | 22 0.0585 0.0050 32.251 0.0732 | | 23 -0.0715 -0.0652 33.404 0.0743 | | 24 0.0241 -0.0049 33.535 0.0933 | | wntestq res, lags(24) Portmanteau test for white noise --------------------------------------- Portmanteau (Q) statistic = 33.5354 Prob &gt; chi2(24) = 0.0933 armaroots 5.1.7 Model selection: use common sample /* Stata -arima- command uses exact MLE, so T=198-1 for all models */ quietly arima yyy, arima(1,1,1) estat ic quietly arima d.yyy, ma(1 2 4 10 11)\t/* best according to AIC &amp; SBC */ estat ic quietly arima yyy, arima(1,1,1) mma(1,4) estat ic quietly arima yyy, arima(2,1,0) mma(1,4) estat ic quietly arima yyy, arima(2,1,0) mar(1,4) estat ic Akaike&#39;s information criterion and Bayesian information criterion ----------------------------------------------------------------------------- Model | Obs ll(null) ll(model) df AIC BIC -------------+--------------------------------------------------------------- . | 197 . 651.9862 4 -1295.972 -1282.84 ----------------------------------------------------------------------------- Note: N=Obs used in calculating BIC; see [R] BIC note. Akaike&#39;s information criterion and Bayesian information criterion ----------------------------------------------------------------------------- Model | Obs ll(null) ll(model) df AIC BIC -------------+--------------------------------------------------------------- . | 197 . 660.5353 7 -1307.071 -1284.088 ----------------------------------------------------------------------------- Note: N=Obs used in calculating BIC; see [R] BIC note. Akaike&#39;s information criterion and Bayesian information criterion ----------------------------------------------------------------------------- Model | Obs ll(null) ll(model) df AIC BIC -------------+--------------------------------------------------------------- . | 197 . 652.5272 5 -1295.054 -1278.638 ----------------------------------------------------------------------------- Note: N=Obs used in calculating BIC; see [R] BIC note. Akaike&#39;s information criterion and Bayesian information criterion ----------------------------------------------------------------------------- Model | Obs ll(null) ll(model) df AIC BIC -------------+--------------------------------------------------------------- . | 197 . 652.7326 5 -1295.465 -1279.049 ----------------------------------------------------------------------------- Note: N=Obs used in calculating BIC; see [R] BIC note. Akaike&#39;s information criterion and Bayesian information criterion ----------------------------------------------------------------------------- Model | Obs ll(null) ll(model) df AIC BIC -------------+--------------------------------------------------------------- . | 197 . 652.5607 5 -1295.121 -1278.705 ----------------------------------------------------------------------------- Note: N=Obs used in calculating BIC; see [R] BIC note. 5.2 ARMA Modeling: d2.yyy 5.2.1 Identification tsline d2.yyy /* standard error: Bartlett formula for MA(q), see classnotes 2.3.2 */ ac d2.yyy, lags(24) level(95) pac d2.yyy, lags(24) level(95)\t/* standard error: 1/sqrt(T) */ 5.2.2 Estimation &amp; Diagnostics 5.2.2.1 Pure MA /* by default, Stata estimate ARIMA using exact MLE */ arima yyy, arima(0,2,1) /* pure MA */ /* arima d2.yyy, arima(0,0,1) */ /* arima d2.yyy, ma(1) */ (setting optimization to BHHH) Iteration 0: log likelihood = 643.01338 Iteration 1: log likelihood = 646.58405 Iteration 2: log likelihood = 646.67078 Iteration 3: log likelihood = 646.6792 Iteration 4: log likelihood = 646.68025 (switching optimization to BFGS) Iteration 5: log likelihood = 646.6804 Iteration 6: log likelihood = 646.68042 ARIMA regression Sample: 1957q3 - 2006q2 Number of obs = 196 Wald chi2(1) = 496.29 Log likelihood = 646.6804 Prob &gt; chi2 = 0.0000 ------------------------------------------------------------------------------ | OPG D2.yyy | Coef. Std. Err. z P&gt;|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- yyy | _cons | .0000297 .0000846 0.35 0.726 -.0001361 .0001954 -------------+---------------------------------------------------------------- ARMA | ma | L1. | -.8812804 .0395591 -22.28 0.000 -.9588148 -.803746 -------------+---------------------------------------------------------------- /sigma | .0088959 .000346 25.71 0.000 .0082178 .009574 ------------------------------------------------------------------------------ Note: The test of the variance against zero is one sided, and the two-sided confidence interval is truncated at zero. cap drop res predict res, residuals tsline res corrgram res, lags(24) -1 0 1 -1 0 1 LAG AC PAC Q Prob&gt;Q [Autocorrelation] [Partial Autocor] ------------------------------------------------------------------------------- 1 0.1762 0.1763 6.1819 0.0129 |- |- 2 0.0391 0.0053 6.4876 0.0390 | | 3 -0.0999 -0.1142 8.496 0.0368 | | 4 -0.0383 0.0012 8.7932 0.0665 | | 5 -0.1389 -0.1206 12.713 0.0262 -| | 6 -0.0579 -0.0218 13.397 0.0371 | | 7 -0.0655 -0.0447 14.277 0.0465 | | 8 -0.1451 -0.1600 18.624 0.0170 -| -| 9 0.0043 0.0456 18.628 0.0285 | | 10 0.1398 0.1298 22.706 0.0119 |- |- 11 0.1821 0.1160 29.659 0.0018 |- | 12 -0.0047 -0.0761 29.664 0.0031 | | 13 -0.0055 -0.0298 29.67 0.0053 | | 14 -0.0090 0.0255 29.687 0.0084 | | 15 -0.0573 -0.0588 30.39 0.0106 | | 16 0.0642 0.1331 31.279 0.0124 | |- 17 -0.0377 -0.0592 31.587 0.0169 | | 18 0.0696 0.1159 32.642 0.0184 | | 19 -0.0175 0.0023 32.71 0.0260 | | 20 0.1155 0.0385 35.651 0.0169 | | 21 0.0277 0.0319 35.821 0.0229 | | 22 0.0265 -0.0186 35.977 0.0305 | | 23 -0.0794 -0.0106 37.391 0.0296 | | 24 0.0071 0.0530 37.402 0.0399 | | wntestq res, lags(24) Portmanteau test for white noise --------------------------------------- Portmanteau (Q) statistic = 37.4018 Prob &gt; chi2(24) = 0.0399 armaroots 5.2.2.2 ARMA arima yyy, arima(1,2,1) /* mixed ARMA: keep */ /* arima d2.yyy, arima(1,0,1) */ /* arima d2.yyy, ar(1) ma(1) */ (setting optimization to BHHH) Iteration 0: log likelihood = 634.47054 Iteration 1: log likelihood = 644.33538 Iteration 2: log likelihood = 648.84623 Iteration 3: log likelihood = 649.86633 Iteration 4: log likelihood = 650.0302 (switching optimization to BFGS) Iteration 5: log likelihood = 650.19363 Iteration 6: log likelihood = 650.27792 Iteration 7: log likelihood = 650.29689 Iteration 8: log likelihood = 650.2971 Iteration 9: log likelihood = 650.2971 ARIMA regression Sample: 1957q3 - 2006q2 Number of obs = 196 Wald chi2(2) = 530.50 Log likelihood = 650.2971 Prob &gt; chi2 = 0.0000 ------------------------------------------------------------------------------ | OPG D2.yyy | Coef. Std. Err. z P&gt;|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- yyy | _cons | .0000198 .0000794 0.25 0.803 -.0001359 .0001755 -------------+---------------------------------------------------------------- ARMA | ar | L1. | .2075997 .0689874 3.01 0.003 .0723868 .3428126 | ma | L1. | -.9174261 .0432478 -21.21 0.000 -1.00219 -.832662 -------------+---------------------------------------------------------------- /sigma | .008734 .0003354 26.04 0.000 .0080766 .0093914 ------------------------------------------------------------------------------ Note: The test of the variance against zero is one sided, and the two-sided confidence interval is truncated at zero. cap drop res predict res, residuals tsline res corrgram res, lags(24) -1 0 1 -1 0 1 LAG AC PAC Q Prob&gt;Q [Autocorrelation] [Partial Autocor] ------------------------------------------------------------------------------- 1 -0.0037 -0.0037 .00273 0.9583 | | 2 0.0475 0.0478 .45496 0.7965 | | 3 -0.0842 -0.0841 1.8802 0.5976 | | 4 0.0267 0.0241 2.0238 0.7314 | | 5 -0.1094 -0.0985 4.4548 0.4859 | | 6 -0.0030 -0.0144 4.4567 0.6151 | | 7 -0.0144 0.0017 4.4996 0.7208 | | 8 -0.1273 -0.1466 7.8428 0.4490 -| -| 9 0.0190 0.0222 7.9177 0.5425 | | 10 0.1200 0.1314 10.923 0.3635 | |- 11 0.1763 0.1666 17.44 0.0955 |- |- 12 -0.0296 -0.0273 17.624 0.1276 | | 13 0.0091 -0.0303 17.642 0.1716 | | 14 0.0155 0.0452 17.693 0.2211 | | 15 -0.0602 -0.0658 18.469 0.2388 | | 16 0.0978 0.1380 20.53 0.1973 | |- 17 -0.0559 -0.0471 21.207 0.2171 | | 18 0.0948 0.1099 23.169 0.1842 | | 19 -0.0457 0.0185 23.626 0.2109 | | 20 0.1292 0.0378 27.306 0.1269 |- | 21 0.0101 0.0442 27.329 0.1602 | | 22 0.0481 -0.0049 27.845 0.1809 | | 23 -0.0802 -0.0230 29.289 0.1709 | | 24 0.0212 0.0307 29.39 0.2058 | | wntestq res, lags(24) Portmanteau test for white noise --------------------------------------- Portmanteau (Q) statistic = 29.3898 Prob &gt; chi2(24) = 0.2058 armaroots "],
["forecasting.html", "6 Forecasting 6.1 In-sample fitted values 6.2 Dynamic/Extrapolation/Recursive forecasts 6.3 1-step-ahead forecasts 6.4 4-step-ahead forecasts 6.5 Forecast evaluation statistics: RMSPE, MPPE, MAPPE", " 6 Forecasting 6.1 In-sample fitted values /* use full sample for estimation */ /* arima d.yyy, arima(1,0,1) */ arima d.yyy, ma(1 2 4 10 11) /* arima d2.yyy, arima(1,0,1) */ (setting optimization to BHHH) Iteration 0: log likelihood = 660.10946 Iteration 1: log likelihood = 660.45577 Iteration 2: log likelihood = 660.51453 Iteration 3: log likelihood = 660.52955 Iteration 4: log likelihood = 660.53352 (switching optimization to BFGS) Iteration 5: log likelihood = 660.5347 Iteration 6: log likelihood = 660.53524 Iteration 7: log likelihood = 660.53526 ARIMA regression Sample: 1957q2 - 2006q2 Number of obs = 197 Wald chi2(5) = 58.32 Log likelihood = 660.5353 Prob &gt; chi2 = 0.0000 ------------------------------------------------------------------------------ | OPG D.yyy | Coef. Std. Err. z P&gt;|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- yyy | _cons | .0168866 .0012613 13.39 0.000 .0144144 .0193588 -------------+---------------------------------------------------------------- ARMA | ma | L1. | .2919739 .0586594 4.98 0.000 .1770036 .4069442 L2. | .146004 .0698232 2.09 0.037 .009153 .282855 L4. | .1824151 .0615452 2.96 0.003 .0617886 .3030415 L10. | .1718678 .063352 2.71 0.007 .0477002 .2960354 L11. | .2708313 .076412 3.54 0.000 .1210665 .4205961 -------------+---------------------------------------------------------------- /sigma | .0084366 .0003307 25.51 0.000 .0077885 .0090847 ------------------------------------------------------------------------------ Note: The test of the variance against zero is one sided, and the two-sided confidence interval is truncated at zero. cap drop y_fit dy_fit predict y_fit, y predict dy_fit, xb label var y_fit &quot;In-sample fitted values of levels&quot; label var dy_fit &quot;In-sample fitted values of differences&quot; list time y_fit dy_fit in 1/6 | time y_fit dy_fit | |------------------------------| 1. | 1957Q1 . .0168866 | 2. | 1957Q2 6.142008 .0168866 | 3. | 1957Q3 6.142532 .0130461 | 4. | 1957Q4 6.160923 .0158793 | 5. | 1958Q1 6.143454 .0089719 | |------------------------------| 6. | 1958Q2 6.122191 .0040943 | +------------------------------+ tsline yyy y_fit if tin(1999q1,) cap drop y_error mse rmspe mppe mappe gen y_error=y_fit-yyy /* compute the forecast evaluation statistics for post-1999Q1 sample */ replace y_error=. if time_2&lt;tq(1999q1) egen mse=mean(y_error^2) gen rmspe=sqrt(mse) egen mppe=mean(y_error/yyy) egen mappe=mean(abs(y_error/yyy)) list rmspe mppe mappe in 1/1 | rmspe mppe mappe | |--------------------------------| 1. | .0054047 .0002028 .0004999 | +--------------------------------+ 6.2 Dynamic/Extrapolation/Recursive forecasts estimation sample is fixed as (1957q1, 1998q4), forecast horizon ranges from 1 to 30 dynamic forecasts start with 1999q1 /* use full sample for estimation */ /* arima d.yyy if tin(,1998q4), arima(1,0,1) */ arima d.yyy if tin(,1998q4), ma(1 2 4 10 11) /* arima d2.yyy if tin(,1998q4), arima(1,0,1) */ (setting optimization to BHHH) Iteration 0: log likelihood = 551.48788 Iteration 1: log likelihood = 551.58321 Iteration 2: log likelihood = 551.60347 Iteration 3: log likelihood = 551.60837 Iteration 4: log likelihood = 551.60985 (switching optimization to BFGS) Iteration 5: log likelihood = 551.61038 Iteration 6: log likelihood = 551.61069 Iteration 7: log likelihood = 551.61072 ARIMA regression Sample: 1957q2 - 1998q4 Number of obs = 167 Wald chi2(5) = 44.93 Log likelihood = 551.6107 Prob &gt; chi2 = 0.0000 ------------------------------------------------------------------------------ | OPG D.yyy | Coef. Std. Err. z P&gt;|z| [95% Conf. Interval] -------------+---------------------------------------------------------------- yyy | _cons | .0175587 .001431 12.27 0.000 .0147539 .0203634 -------------+---------------------------------------------------------------- ARMA | ma | L1. | .2914819 .0661621 4.41 0.000 .1618066 .4211572 L2. | .1317165 .080453 1.64 0.102 -.0259686 .2894015 L4. | .1685373 .0698476 2.41 0.016 .0316385 .3054361 L10. | .1644854 .0720823 2.28 0.022 .0232067 .305764 L11. | .2766332 .0868364 3.19 0.001 .1064369 .4468294 -------------+---------------------------------------------------------------- /sigma | .0088642 .0003882 22.83 0.000 .0081033 .009625 ------------------------------------------------------------------------------ Note: The test of the variance against zero is one sided, and the two-sided confidence interval is truncated at zero. cap drop y_dyn dy_dyn\t/* forecasts start in 1999Q1 */ predict y_dyn, y dynamic(tq(1999q1)) /* If dynamic() is not specified, actual values are used for lagged values of y(t) */ /* to produce one-step-ahead forecasts. */ predict dy_dyn, xb dynamic(tq(1999q1)) label var y_dyn &quot;dynamic forecasts of levels&quot; label var dy_dyn &quot;dynamic forecasts of differences&quot; list time y_dyn dy_dyn if time_2&gt;=tq(1999q1) | time y_dyn dy_dyn | |------------------------------| 169. | 1999Q1 9.118066 .0182319 | 170. | 1999Q2 9.132398 .0143322 | 171. | 1999Q3 9.15017 .0177723 | 172. | 1999Q4 9.167582 .0174116 | 173. | 2000Q1 9.185462 .0178808 | |------------------------------| 174. | 2000Q2 9.202712 .0172498 | 175. | 2000Q3 9.219089 .016376 | 176. | 2000Q4 9.235211 .0161228 | 177. | 2001Q1 9.250524 .0153125 | 178. | 2001Q2 9.268696 .0181724 | |------------------------------| 179. | 2001Q3 9.286902 .018206 | 180. | 2001Q4 9.304461 .0175587 | 181. | 2002Q1 9.32202 .0175587 | 182. | 2002Q2 9.339578 .0175587 | 183. | 2002Q3 9.357137 .0175587 | |------------------------------| 184. | 2002Q4 9.374695 .0175587 | 185. | 2003Q1 9.392254 .0175587 | 186. | 2003Q2 9.409813 .0175587 | 187. | 2003Q3 9.427371 .0175587 | 188. | 2003Q4 9.44493 .0175587 | |------------------------------| 189. | 2004Q1 9.462488 .0175587 | 190. | 2004Q2 9.480047 .0175587 | 191. | 2004Q3 9.497605 .0175587 | 192. | 2004Q4 9.515164 .0175587 | 193. | 2005Q1 9.532723 .0175587 | |------------------------------| 194. | 2005Q2 9.550282 .0175587 | 195. | 2005Q3 9.567841 .0175587 | 196. | 2005Q4 9.585399 .0175587 | 197. | 2006Q1 9.602958 .0175587 | 198. | 2006Q2 9.620517 .0175587 | |------------------------------| 199. | 2006Q3 9.638075 .0175587 | 200. | 2006Q4 9.655634 .0175587 | +------------------------------+ tsline yyy y_dyn if tin(1999q1,) cap drop y_error mse rmspe mppe mappe gen y_error=y_dyn-yyy replace y_error=. if time_2&lt;tq(1999q1) egen mse=mean(y_error^2) gen rmspe=sqrt(mse) egen mppe=mean(y_error/yyy) egen mappe=mean(abs(y_error/yyy)) list rmspe mppe mappe in 1/1 | rmspe mppe mappe | |------------------------------| 1. | .0936204 .008643 .008643 | +------------------------------+ 6.3 1-step-ahead forecasts estimation sample starts with (1957q1, 1998q4), then expands with one additonal observation at a time, forecast horizon is fixed as h=1 reestimate the model with each additional observation cap drop y_hat gen y_hat = . cap drop y_hat_table gen y_hat_table = . label var y_hat_table &quot;yyy, ARIMA, h=1&quot; set more off local h = 1 /* set the h for h-step-ahead-forcast */ local i=168 /* set last obs of estimation sample */ local l=`i&#39;+`h&#39; local k=198 /* set last obs of forecast sample */ while `i&#39; &lt;=`k&#39;-`h&#39; { /* quietly arima d.yyy in 1/`i&#39;, arima(1,0,1) change model as needed */ quietly arima d.yyy in 1/`i&#39;, ma(1 2 4 10 11) /* quietly arima d2.yyy in 1/`i&#39;, arima(1,0,1)\t*/ cap drop y_hat quietly predict y_hat, y local j=`i&#39;+`h&#39; /* list time y_hat in `j&#39;/`j&#39; */ quietly replace y_hat_table = y_hat in `j&#39;/`j&#39; local i=`i&#39;+1 } list time yyy y_hat_table in `l&#39;/`k&#39; tsline yyy y_hat_table in `l&#39;/`k&#39; | time yyy y_hat_~e | |------------------------------| 169. | 1999Q1 9.112352 9.118066 | 170. | 1999Q2 9.12414 9.125053 | 171. | 1999Q3 9.13922 9.140858 | 172. | 1999Q4 9.161098 9.155983 | 173. | 2000Q1 9.172576 9.179264 | |------------------------------| 174. | 2000Q2 9.192461 9.18838 | 175. | 2000Q3 9.196454 9.208769 | 176. | 2000Q4 9.205689 9.210423 | 177. | 2001Q1 9.212488 9.216632 | 178. | 2001Q2 9.223148 9.22934 | |------------------------------| 179. | 2001Q3 9.22376 9.235682 | 180. | 2001Q4 9.232718 9.23404 | 181. | 2002Q1 9.243127 9.246629 | 182. | 2002Q2 9.252115 9.258266 | 183. | 2002Q3 9.261737 9.264979 | |------------------------------| 184. | 2002Q4 9.267769 9.275546 | 185. | 2003Q1 9.278522 9.280374 | 186. | 2003Q2 9.290241 9.288405 | 187. | 2003Q3 9.313447 9.304872 | 188. | 2003Q4 9.325409 9.32963 | |------------------------------| 189. | 2004Q1 9.344075 9.338203 | 190. | 2004Q2 9.363002 9.359034 | 191. | 2004Q3 9.375804 9.382712 | 192. | 2004Q4 9.390183 9.388437 | 193. | 2005Q1 9.406992 9.405504 | |------------------------------| 194. | 2005Q2 9.421096 9.423127 | 195. | 2005Q3 9.439346 9.43382 | 196. | 2005Q4 9.451756 9.457699 | 197. | 2006Q1 9.473351 9.469869 | 198. | 2006Q2 9.487767 9.491684 | +------------------------------+ (file plot35.svg written in SVG format) cap drop y_error mse rmspe mppe mappe gen y_error=y_hat_table-yyy egen mse= mean(y_error^2) gen rmspe= sqrt(mse) egen mppe=mean(y_error/yyy) egen mappe=mean(abs(y_error/yyy)) list rmspe mppe mappe in 1/1 | rmspe mppe mappe | |-------------------------------| 1. | .005529 .0002152 .0005132 | +-------------------------------+ cap drop y_h1 gen y_h1=y_hat_table label var y_h1 &quot;1-step-ahead forecasts of levels&quot; 6.4 4-step-ahead forecasts estimation sample starts with (1957q1, 1998q4), then expands with one additonal observation at a time, forecast horizon is fixed as h=4 reestimate the model with each additional observation cap drop y_hat gen y_hat = . cap drop y_hat_table gen y_hat_table = . label var y_hat_table &quot;yyy, ARIMA, h=4&quot; set more off local h = 4 /* set the h for h-step-ahead-forcast */ local i=168 /* set last obs of estimation sample */ local t0=tq(1998q4) /* set ending date of estimation sample */ local l=`i&#39;+`h&#39; local k=198 /* set last obs of forecast sample */ while `i&#39; &lt;=`k&#39;-`h&#39; { /* quietly arima d.yyy in 1/`i&#39;, arima(1,0,1) change model as needed */ quietly arima d.yyy in 1/`i&#39;, ma(1 2 4 10 11) /* quietly arima d2.yyy in 1/`i&#39;, arima(1,0,1) */ cap drop y_hat quietly predict y_hat, y dynamic(`t0&#39;+1) local j=`i&#39;+`h&#39; /*\tlist time y_hat in `j&#39;/`j&#39; */ quietly replace y_hat_table = y_hat in `j&#39;/`j&#39; local i=`i&#39;+1 local t0=`t0&#39;+1 } list time yyy y_hat_table in `l&#39;/`k&#39; tsline yyy y_hat_table in `l&#39;/`k&#39; | time yyy y_hat_~e | |------------------------------| 172. | 1999Q4 9.161098 9.167582 | 173. | 2000Q1 9.172576 9.1763 | 174. | 2000Q2 9.192461 9.192025 | 175. | 2000Q3 9.196454 9.205711 | 176. | 2000Q4 9.205689 9.229968 | |------------------------------| 177. | 2001Q1 9.212488 9.234512 | 178. | 2001Q2 9.223148 9.259163 | 179. | 2001Q3 9.22376 9.256402 | 180. | 2001Q4 9.232718 9.264427 | 181. | 2002Q1 9.243127 9.274498 | |------------------------------| 182. | 2002Q2 9.252115 9.282114 | 183. | 2002Q3 9.261737 9.27998 | 184. | 2002Q4 9.267769 9.293777 | 185. | 2003Q1 9.278522 9.304202 | 186. | 2003Q2 9.290241 9.306887 | |------------------------------| 187. | 2003Q3 9.313447 9.316544 | 188. | 2003Q4 9.325409 9.318444 | 189. | 2004Q1 9.344075 9.328505 | 190. | 2004Q2 9.363002 9.344928 | 191. | 2004Q3 9.375804 9.375166 | |------------------------------| 192. | 2004Q4 9.390183 9.382996 | 193. | 2005Q1 9.406992 9.407466 | 194. | 2005Q2 9.421096 9.428817 | 195. | 2005Q3 9.439346 9.431775 | 196. | 2005Q4 9.451756 9.451321 | |------------------------------| 197. | 2006Q1 9.473351 9.472584 | 198. | 2006Q2 9.487767 9.487797 | +------------------------------+ (file plot36.svg written in SVG format) cap drop y_error mse rmspe mppe mappe gen y_error=y_hat_table-yyy egen mse= mean(y_error^2) gen rmspe= sqrt(mse) egen mppe=mean(y_error/yyy) egen mappe=mean(abs(y_error/yyy)) list rmspe mppe mappe in 1/1 | rmspe mppe mappe | |--------------------------------| 1. | .0184706 .0010759 .0015318 | +--------------------------------+ cap drop y_h4 gen y_h4=y_hat_table label var y_h4 &quot;4-step-ahead forecasts of levels&quot; 6.5 Forecast evaluation statistics: RMSPE, MPPE, MAPPE check Notes_ARIMA.pdf for details tsline yyy y_fit y_dyn y_h1 y_h4 if tin(1999q1,) "]
]
